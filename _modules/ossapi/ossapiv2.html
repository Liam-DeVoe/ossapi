<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" />

    <!-- Generated with Sphinx 6.1.3 and Furo 2022.12.07 -->
        <title>ossapi.ossapiv2 - ossapi v3.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">ossapi v3.1.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">ossapi v3.1.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">ossapi</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Quickstart</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../creating-a-client.html">Creating a Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../grants.html">Grant Types</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../pagination.html">Pagination</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../expandable-models.html">Expandable Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../foreign-keys.html">Following Foreign Keys</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../serializing-models.html">Serializing Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../async.html">Async</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Endpoints</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../endpoints.html">Beatmaps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../endpoints.html#beatmapsets">Beatmapsets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../endpoints.html#changelog">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../endpoints.html#chat">Chat</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../endpoints.html#comments">Comments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../endpoints.html#forums">Forums</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../endpoints.html#friends">Friends</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../endpoints.html#home">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../endpoints.html#matches">Matches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../endpoints.html#me">Me</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../endpoints.html#news">News</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../endpoints.html#oauth">Oauth</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../endpoints.html#rankings">Rankings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../endpoints.html#rooms">Rooms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../endpoints.html#scores">Scores</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../endpoints.html#seasonal-backgrounds">Seasonal Backgrounds</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../endpoints.html#spotlights">Spotlights</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../endpoints.html#users">Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../endpoints.html#wiki">Wiki</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../appendix.html">Enums</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix.html#module-ossapi.models">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix.html#module-ossapi.ossapiv2">Ossapi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix.html#module-ossapi.ossapiv2_async">OssapiAsync</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix.html#module-0">Scope</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix.html#module-1">Grant</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix.html#module-ossapi.replay">Replay</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <h1>Source code for ossapi.ossapiv2</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span><span class="p">,</span> <span class="n">TypeVar</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">_GenericAlias</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">webbrowser</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">unquote</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">from</span> <span class="nn">requests_oauthlib</span> <span class="kn">import</span> <span class="n">OAuth2Session</span>
<span class="kn">from</span> <span class="nn">oauthlib.oauth2</span> <span class="kn">import</span> <span class="p">(</span><span class="n">BackendApplicationClient</span><span class="p">,</span> <span class="n">TokenExpiredError</span><span class="p">,</span>
    <span class="n">AccessDeniedError</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">oauthlib.oauth2.rfc6749.errors</span> <span class="kn">import</span> <span class="n">InsufficientScopeError</span>
<span class="kn">from</span> <span class="nn">oauthlib.oauth2.rfc6749.tokens</span> <span class="kn">import</span> <span class="n">OAuth2Token</span>
<span class="kn">import</span> <span class="nn">osrparse</span>
<span class="kn">from</span> <span class="nn">typing_utils</span> <span class="kn">import</span> <span class="n">issubtype</span><span class="p">,</span> <span class="n">get_type_hints</span><span class="p">,</span> <span class="n">get_origin</span><span class="p">,</span> <span class="n">get_args</span>

<span class="kn">from</span> <span class="nn">ossapi.models</span> <span class="kn">import</span> <span class="p">(</span><span class="n">Beatmap</span><span class="p">,</span> <span class="n">BeatmapCompact</span><span class="p">,</span> <span class="n">BeatmapUserScore</span><span class="p">,</span>
    <span class="n">ForumTopicAndPosts</span><span class="p">,</span> <span class="n">Search</span><span class="p">,</span> <span class="n">CommentBundle</span><span class="p">,</span> <span class="n">Cursor</span><span class="p">,</span> <span class="n">Score</span><span class="p">,</span>
    <span class="n">BeatmapsetSearchResult</span><span class="p">,</span> <span class="n">ModdingHistoryEventsBundle</span><span class="p">,</span> <span class="n">User</span><span class="p">,</span> <span class="n">Rankings</span><span class="p">,</span>
    <span class="n">BeatmapScores</span><span class="p">,</span> <span class="n">KudosuHistory</span><span class="p">,</span> <span class="n">Beatmapset</span><span class="p">,</span> <span class="n">BeatmapPlaycount</span><span class="p">,</span> <span class="n">Spotlight</span><span class="p">,</span>
    <span class="n">Spotlights</span><span class="p">,</span> <span class="n">WikiPage</span><span class="p">,</span> <span class="n">_Event</span><span class="p">,</span> <span class="n">Event</span><span class="p">,</span> <span class="n">BeatmapsetDiscussionPosts</span><span class="p">,</span> <span class="n">Build</span><span class="p">,</span>
    <span class="n">ChangelogListing</span><span class="p">,</span> <span class="n">MultiplayerScores</span><span class="p">,</span>
    <span class="n">BeatmapsetDiscussionVotes</span><span class="p">,</span> <span class="n">CreatePMResponse</span><span class="p">,</span> <span class="n">BeatmapsetDiscussions</span><span class="p">,</span>
    <span class="n">UserCompact</span><span class="p">,</span> <span class="n">NewsListing</span><span class="p">,</span> <span class="n">NewsPost</span><span class="p">,</span> <span class="n">SeasonalBackgrounds</span><span class="p">,</span> <span class="n">BeatmapsetCompact</span><span class="p">,</span>
    <span class="n">BeatmapUserScores</span><span class="p">,</span> <span class="n">DifficultyAttributes</span><span class="p">,</span> <span class="n">Users</span><span class="p">,</span> <span class="n">Beatmaps</span><span class="p">,</span>
    <span class="n">CreateForumTopicResponse</span><span class="p">,</span> <span class="n">ForumPoll</span><span class="p">,</span> <span class="n">ForumPost</span><span class="p">,</span> <span class="n">ForumTopic</span><span class="p">,</span> <span class="n">Room</span><span class="p">,</span>
    <span class="n">RoomLeaderboard</span><span class="p">,</span> <span class="n">Matches</span><span class="p">,</span> <span class="n">Match</span><span class="p">,</span> <span class="n">MatchResponse</span><span class="p">,</span> <span class="n">ChatChannel</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">ossapi.enums</span> <span class="kn">import</span> <span class="p">(</span><span class="n">GameMode</span><span class="p">,</span> <span class="n">ScoreType</span><span class="p">,</span> <span class="n">RankingFilter</span><span class="p">,</span> <span class="n">RankingType</span><span class="p">,</span>
    <span class="n">UserBeatmapType</span><span class="p">,</span> <span class="n">BeatmapDiscussionPostSort</span><span class="p">,</span> <span class="n">UserLookupKey</span><span class="p">,</span>
    <span class="n">BeatmapsetEventType</span><span class="p">,</span> <span class="n">CommentableType</span><span class="p">,</span> <span class="n">CommentSort</span><span class="p">,</span> <span class="n">ForumTopicSort</span><span class="p">,</span>
    <span class="n">SearchMode</span><span class="p">,</span> <span class="n">MultiplayerScoresSort</span><span class="p">,</span> <span class="n">BeatmapsetDiscussionVote</span><span class="p">,</span>
    <span class="n">BeatmapsetDiscussionVoteSort</span><span class="p">,</span> <span class="n">BeatmapsetStatus</span><span class="p">,</span> <span class="n">MessageType</span><span class="p">,</span>
    <span class="n">BeatmapsetSearchCategory</span><span class="p">,</span> <span class="n">BeatmapsetSearchMode</span><span class="p">,</span>
    <span class="n">BeatmapsetSearchExplicitContent</span><span class="p">,</span> <span class="n">BeatmapsetSearchGenre</span><span class="p">,</span>
    <span class="n">BeatmapsetSearchLanguage</span><span class="p">,</span> <span class="n">NewsPostKey</span><span class="p">,</span> <span class="n">BeatmapsetSearchSort</span><span class="p">,</span> <span class="n">RoomSearchType</span><span class="p">,</span>
    <span class="n">ChangelogMessageFormat</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">ossapi.utils</span> <span class="kn">import</span> <span class="p">(</span><span class="n">is_compatible_type</span><span class="p">,</span> <span class="n">is_primitive_type</span><span class="p">,</span> <span class="n">is_optional</span><span class="p">,</span>
    <span class="n">is_base_model_type</span><span class="p">,</span> <span class="n">is_model_type</span><span class="p">,</span> <span class="n">is_high_model_type</span><span class="p">,</span> <span class="n">Field</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">ossapi.mod</span> <span class="kn">import</span> <span class="n">Mod</span>
<span class="kn">from</span> <span class="nn">ossapi.replay</span> <span class="kn">import</span> <span class="n">Replay</span>

<span class="c1"># our `request` function below relies on the ordering of these types. The</span>
<span class="c1"># base type must come first, with any auxiliary types that the base type accepts</span>
<span class="c1"># coming after.</span>
<span class="c1"># These types are intended to provide better type hinting for consumers. We</span>
<span class="c1"># want to support the ability to pass `&quot;osu&quot;` instead of `GameMode.STD`,</span>
<span class="c1"># for instance. We automatically convert any value to its base class if the</span>
<span class="c1"># relevant parameter has a type hint of the form below (see `request` for</span>
<span class="c1"># details).</span>
<span class="n">GameModeT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">GameMode</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">ScoreTypeT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">ScoreType</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">ModT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">Mod</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span>
<span class="n">RankingFilterT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">RankingFilter</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">RankingTypeT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">RankingType</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">UserBeatmapTypeT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">UserBeatmapType</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">BeatmapDiscussionPostSortT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">BeatmapDiscussionPostSort</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">UserLookupKeyT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">UserLookupKey</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">BeatmapsetEventTypeT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">BeatmapsetEventType</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">CommentableTypeT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">CommentableType</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">CommentSortT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">CommentSort</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">ForumTopicSortT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForumTopicSort</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">SearchModeT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">SearchMode</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">MultiplayerScoresSortT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">MultiplayerScoresSort</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">BeatmapsetDiscussionVoteT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">BeatmapsetDiscussionVote</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
<span class="n">BeatmapsetDiscussionVoteSortT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">BeatmapsetDiscussionVoteSort</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">MessageTypeT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">MessageType</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">BeatmapsetStatusT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">BeatmapsetStatus</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">BeatmapsetSearchCategoryT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">BeatmapsetSearchCategory</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">BeatmapsetSearchModeT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">BeatmapsetSearchMode</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
<span class="n">BeatmapsetSearchExplicitContentT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">BeatmapsetSearchExplicitContent</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">BeatmapsetSearchGenreT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">BeatmapsetSearchGenre</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
<span class="n">BeatmapsetSearchLanguageT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">BeatmapsetSearchLanguage</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">NewsPostKeyT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">NewsPostKey</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">BeatmapsetSearchSortT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">BeatmapsetSearchSort</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">RoomSearchTypeT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">RoomSearchType</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>

<span class="n">BeatmapIdT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">BeatmapCompact</span><span class="p">]</span>
<span class="n">UserIdT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">UserCompact</span><span class="p">]</span>
<span class="n">BeatmapsetIdT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">BeatmapCompact</span><span class="p">,</span> <span class="n">BeatmapsetCompact</span><span class="p">]</span>
<span class="n">RoomIdT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Room</span><span class="p">]</span>
<span class="n">MatchIdT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Match</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">request</span><span class="p">(</span><span class="n">scope</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">requires_user</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">category</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles various validation and preparation tasks for any endpoint request</span>
<span class="sd">    method.</span>

<span class="sd">    This method does the following things:</span>
<span class="sd">    * makes sure the client has the requuired scope to access the endpoint in</span>
<span class="sd">      question</span>
<span class="sd">    * makes sure the client has the right grant to access the endpoint in</span>
<span class="sd">      question (the client credentials grant cannot access endpoints which</span>
<span class="sd">      require the user to be &quot;logged in&quot;, such as downloading a replay)</span>
<span class="sd">    * converts parameters to an instance of a base model if the parameter is</span>
<span class="sd">      annotated as being a base model. This means, for instance, that a function</span>
<span class="sd">      with an argument annotated as ``ModT`` (``Union[Mod, str, int, list]``)</span>
<span class="sd">      will have the value of that parameter automatically converted to a</span>
<span class="sd">      ``Mod``, even if the user passes a `str`.</span>
<span class="sd">    * converts arguments of type ``BeatmapIdT`` or ``UserIdT`` into a beatmap or</span>
<span class="sd">      user id, if the passed argument was a ``BeatmapCompact`` or</span>
<span class="sd">      ``UserCompact`` respectively.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    scope: Scope</span>
<span class="sd">        The scope required for this endpoint. If ``None``, no scope is required</span>
<span class="sd">        and any authenticated cliient can access it.</span>
<span class="sd">    requires_user: bool</span>
<span class="sd">        Whether this endpoint requires a user to be associated with the grant.</span>
<span class="sd">        Currently, only authtorization code grants can access these endpoints.</span>
<span class="sd">    category: str</span>
<span class="sd">        What category of endpoints this endpoint belongs to. Used for grouping</span>
<span class="sd">        in the docs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">function</span><span class="p">):</span>
        <span class="n">instantiate</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">type_</span> <span class="ow">in</span> <span class="n">function</span><span class="o">.</span><span class="vm">__annotations__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">origin</span> <span class="o">=</span> <span class="n">get_origin</span><span class="p">(</span><span class="n">type_</span><span class="p">)</span>
            <span class="n">args</span> <span class="o">=</span> <span class="n">get_args</span><span class="p">(</span><span class="n">type_</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">origin</span> <span class="ow">is</span> <span class="n">Union</span> <span class="ow">and</span> <span class="n">is_base_model_type</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="n">instantiate</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">type_</span>

        <span class="n">arg_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">function</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span>

        <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="bp">self</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">scope</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">scope</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scopes</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">InsufficientScopeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;A scope of </span><span class="si">{</span><span class="n">scope</span><span class="si">}</span><span class="s2"> is required &quot;</span>
                    <span class="s2">&quot;for this endpoint. Your client&#39;s current scopes are &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">scopes</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">requires_user</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">grant</span> <span class="ow">is</span> <span class="n">Grant</span><span class="o">.</span><span class="n">CLIENT_CREDENTIALS</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">AccessDeniedError</span><span class="p">(</span><span class="s2">&quot;To access this endpoint you must be &quot;</span>
                    <span class="s2">&quot;authorized using the authorization code grant. You are &quot;</span>
                    <span class="s2">&quot;currently authorized with the client credentials grant&quot;</span><span class="p">)</span>

            <span class="c1"># we may need to edit this later so convert from tuple</span>
            <span class="n">args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">id_from_id_type</span><span class="p">(</span><span class="n">arg_name</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
                <span class="n">annotations</span> <span class="o">=</span> <span class="n">function</span><span class="o">.</span><span class="vm">__annotations__</span>
                <span class="k">if</span> <span class="n">arg_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">annotations</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span>
                <span class="n">arg_type</span> <span class="o">=</span> <span class="n">annotations</span><span class="p">[</span><span class="n">arg_name</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">issubtype</span><span class="p">(</span><span class="n">BeatmapsetIdT</span><span class="p">,</span> <span class="n">arg_type</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">BeatmapCompact</span><span class="p">):</span>
                        <span class="k">return</span> <span class="n">arg</span><span class="o">.</span><span class="n">beatmapset_id</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">BeatmapsetCompact</span><span class="p">):</span>
                        <span class="k">return</span> <span class="n">arg</span><span class="o">.</span><span class="n">id</span>
                <span class="k">elif</span> <span class="n">issubtype</span><span class="p">(</span><span class="n">BeatmapIdT</span><span class="p">,</span> <span class="n">arg_type</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">BeatmapCompact</span><span class="p">):</span>
                        <span class="k">return</span> <span class="n">arg</span><span class="o">.</span><span class="n">id</span>
                <span class="k">elif</span> <span class="n">issubtype</span><span class="p">(</span><span class="n">UserIdT</span><span class="p">,</span> <span class="n">arg_type</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">UserCompact</span><span class="p">):</span>
                        <span class="k">return</span> <span class="n">arg</span><span class="o">.</span><span class="n">id</span>
                <span class="k">elif</span> <span class="n">issubtype</span><span class="p">(</span><span class="n">RoomIdT</span><span class="p">,</span> <span class="n">arg_type</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">Room</span><span class="p">):</span>
                        <span class="k">return</span> <span class="n">arg</span><span class="o">.</span><span class="n">id</span>
                <span class="k">elif</span> <span class="n">issubtype</span><span class="p">(</span><span class="n">MatchIdT</span><span class="p">,</span> <span class="n">arg_type</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">Match</span><span class="p">):</span>
                        <span class="k">return</span> <span class="n">arg</span><span class="o">.</span><span class="n">id</span>

            <span class="c1"># args and kwargs are handled separately, but in a similar fashion.</span>
            <span class="c1"># The difference is that for `args` we need to know the name of</span>
            <span class="c1"># the argument so we can look up its type hint and see if it&#39;s a</span>
            <span class="c1"># parameter we need to convert.</span>

            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">arg_name</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">arg_names</span><span class="p">,</span> <span class="n">args</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">arg_name</span> <span class="ow">in</span> <span class="n">instantiate</span><span class="p">:</span>
                    <span class="n">type_</span> <span class="o">=</span> <span class="n">instantiate</span><span class="p">[</span><span class="n">arg_name</span><span class="p">]</span>
                    <span class="c1"># allow users to pass None for optional args. Without this</span>
                    <span class="c1"># we would try to instantiate types like `GameMode(None)`</span>
                    <span class="c1"># which would error.</span>
                    <span class="k">if</span> <span class="n">is_optional</span><span class="p">(</span><span class="n">type_</span><span class="p">)</span> <span class="ow">and</span> <span class="n">arg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="n">type_</span> <span class="o">=</span> <span class="n">get_args</span><span class="p">(</span><span class="n">type_</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">type_</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
                <span class="n">id_</span> <span class="o">=</span> <span class="n">id_from_id_type</span><span class="p">(</span><span class="n">arg_name</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">id_</span><span class="p">:</span>
                    <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">id_</span>

            <span class="k">for</span> <span class="n">arg_name</span><span class="p">,</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">arg_name</span> <span class="ow">in</span> <span class="n">instantiate</span><span class="p">:</span>
                    <span class="n">type_</span> <span class="o">=</span> <span class="n">instantiate</span><span class="p">[</span><span class="n">arg_name</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">is_optional</span><span class="p">(</span><span class="n">type_</span><span class="p">)</span> <span class="ow">and</span> <span class="n">arg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="n">type_</span> <span class="o">=</span> <span class="n">get_args</span><span class="p">(</span><span class="n">type_</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">kwargs</span><span class="p">[</span><span class="n">arg_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">type_</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
                <span class="n">id_</span> <span class="o">=</span> <span class="n">id_from_id_type</span><span class="p">(</span><span class="n">arg_name</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">id_</span><span class="p">:</span>
                    <span class="n">kwargs</span><span class="p">[</span><span class="n">arg_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">id_</span>

            <span class="k">return</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># for docs generation</span>
        <span class="n">wrapper</span><span class="o">.</span><span class="n">__ossapi_category__</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">wrapper</span><span class="o">.</span><span class="n">__ossapi_scope__</span> <span class="o">=</span> <span class="n">scope</span>

        <span class="k">return</span> <span class="n">wrapper</span>
    <span class="k">return</span> <span class="n">decorator</span>


<div class="viewcode-block" id="Grant"><a class="viewcode-back" href="../../appendix.html#ossapi.ossapiv2.Grant">[docs]</a><span class="k">class</span> <span class="nc">Grant</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The grant types used by the api.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">CLIENT_CREDENTIALS</span> <span class="o">=</span> <span class="s2">&quot;client&quot;</span>
    <span class="n">AUTHORIZATION_CODE</span> <span class="o">=</span> <span class="s2">&quot;authorization&quot;</span></div>

<div class="viewcode-block" id="Scope"><a class="viewcode-back" href="../../appendix.html#ossapi.ossapiv2.Scope">[docs]</a><span class="k">class</span> <span class="nc">Scope</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The OAuth scopes used by the api.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">CHAT_WRITE</span> <span class="o">=</span> <span class="s2">&quot;chat.write&quot;</span>
    <span class="n">DELEGATE</span> <span class="o">=</span> <span class="s2">&quot;delegate&quot;</span>
    <span class="n">FORUM_WRITE</span> <span class="o">=</span> <span class="s2">&quot;forum.write&quot;</span>
    <span class="n">FRIENDS_READ</span> <span class="o">=</span> <span class="s2">&quot;friends.read&quot;</span>
    <span class="n">IDENTIFY</span> <span class="o">=</span> <span class="s2">&quot;identify&quot;</span>
    <span class="n">PUBLIC</span> <span class="o">=</span> <span class="s2">&quot;public&quot;</span></div>


<div class="viewcode-block" id="Ossapi"><a class="viewcode-back" href="../../appendix.html#ossapi.ossapiv2.Ossapi">[docs]</a><span class="k">class</span> <span class="nc">Ossapi</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A wrapper around osu! api v2. The main entry point for ossapi.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    client_id: int</span>
<span class="sd">        The id of the client to authenticate with.</span>
<span class="sd">    client_secret: str</span>
<span class="sd">        The secret of the client to authenticate with.</span>
<span class="sd">    redirect_uri: str</span>
<span class="sd">        The redirect uri for the client. Must be passed if using the</span>
<span class="sd">        authorization code grant. This must exactly match the redirect uri on</span>
<span class="sd">        the client&#39;s settings page. Additionally, in order for ossapi to receive</span>
<span class="sd">        authentication from this redirect uri, it must be a port on localhost.</span>
<span class="sd">        So &quot;http://localhost:3914/&quot;, &quot;http://localhost:727/&quot;, etc are all valid</span>
<span class="sd">        redirect uris. You can change your client&#39;s redirect uri from its</span>
<span class="sd">        settings page.</span>
<span class="sd">    scopes: List[str]</span>
<span class="sd">        What scopes to request when authenticating.</span>
<span class="sd">    grant: Grant or str</span>
<span class="sd">        Which oauth grant (aka flow) to use when authenticating with the api.</span>
<span class="sd">        The osu api offers the client credentials (pass &quot;client&quot; for this</span>
<span class="sd">        parameter) and authorization code (pass &quot;authorization&quot; for this</span>
<span class="sd">        parameter) grants.</span>
<span class="sd">        |br|</span>
<span class="sd">        The authorization code grant requires user interaction to authenticate</span>
<span class="sd">        the first time, but grants full access to the api. In contrast, the</span>
<span class="sd">        client credentials grant does not require user interaction to</span>
<span class="sd">        authenticate, but only grants guest user access to the api. This means</span>
<span class="sd">        you will not be able to do things like download replays on the client</span>
<span class="sd">        credentials grant.</span>
<span class="sd">        |br|</span>
<span class="sd">        If not passed, the grant will be automatically inferred as follows: if</span>
<span class="sd">        ``redirect_uri`` is passed, use the authorization code grant. If</span>
<span class="sd">        ``redirect_uri`` is not passed, use the client credentials grant.</span>
<span class="sd">    strict: bool</span>
<span class="sd">        Whether to run in &quot;strict&quot; mode. In strict mode, ossapi will raise an</span>
<span class="sd">        exception if the api returns an attribute in a response which we didn&#39;t</span>
<span class="sd">        expect to be there. This is useful for developers which want to catch</span>
<span class="sd">        new attributes as they get added. More checks may be added in the future</span>
<span class="sd">        for things which developers may want to be aware of, but normal users do</span>
<span class="sd">        not want to have an exception raised for.</span>
<span class="sd">        |br|</span>
<span class="sd">        If you are not a developer, you are very unlikely to want to use this</span>
<span class="sd">        parameter.</span>
<span class="sd">    token_directory: str</span>
<span class="sd">        If passed, the given directory will be used to store and retrieve token</span>
<span class="sd">        files instead of locally wherever ossapi is installed. Useful if you</span>
<span class="sd">        want more control over token files.</span>
<span class="sd">    token_key: str</span>
<span class="sd">        If passed, the given key will be used to name the token file instead of</span>
<span class="sd">        an automatically generated one. Note that if you pass this, you are</span>
<span class="sd">        taking responsibility for making sure it is unique / unused, and also</span>
<span class="sd">        for remembering the key you passed if you wish to eg remove the token in</span>
<span class="sd">        the future, which requires the key.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">TOKEN_URL</span> <span class="o">=</span> <span class="s2">&quot;https://osu.ppy.sh/oauth/token&quot;</span>
    <span class="n">AUTH_CODE_URL</span> <span class="o">=</span> <span class="s2">&quot;https://osu.ppy.sh/oauth/authorize&quot;</span>
    <span class="n">BASE_URL</span> <span class="o">=</span> <span class="s2">&quot;https://osu.ppy.sh/api/v2&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">client_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">client_secret</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">redirect_uri</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">scopes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Scope</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">],</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">grant</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Grant</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">token_directory</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">token_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">access_token</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">refresh_token</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">grant</span><span class="p">:</span>
            <span class="n">grant</span> <span class="o">=</span> <span class="p">(</span><span class="n">Grant</span><span class="o">.</span><span class="n">AUTHORIZATION_CODE</span> <span class="k">if</span> <span class="n">redirect_uri</span> <span class="k">else</span>
                <span class="n">Grant</span><span class="o">.</span><span class="n">CLIENT_CREDENTIALS</span><span class="p">)</span>
        <span class="n">grant</span> <span class="o">=</span> <span class="n">Grant</span><span class="p">(</span><span class="n">grant</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">grant</span> <span class="o">=</span> <span class="n">grant</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span> <span class="o">=</span> <span class="n">client_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client_secret</span> <span class="o">=</span> <span class="n">client_secret</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redirect_uri</span> <span class="o">=</span> <span class="n">redirect_uri</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scopes</span> <span class="o">=</span> <span class="p">[</span><span class="n">Scope</span><span class="p">(</span><span class="n">scope</span><span class="p">)</span> <span class="k">for</span> <span class="n">scope</span> <span class="ow">in</span> <span class="n">scopes</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">strict</span> <span class="o">=</span> <span class="n">strict</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">token_key</span> <span class="o">=</span> <span class="n">token_key</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen_token_key</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grant</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_secret</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scopes</span><span class="p">)</span>

        <span class="c1"># support saving tokens when being run from pyinstaller</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s1">&#39;_MEIPASS&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">token_directory</span><span class="p">:</span>
            <span class="n">token_directory</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">_MEIPASS</span> <span class="c1"># pylint: disable=no-member</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">token_directory</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">Path</span><span class="p">(</span><span class="n">token_directory</span><span class="p">)</span> <span class="k">if</span> <span class="n">token_directory</span> <span class="k">else</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">token_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">token_directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">token_key</span><span class="si">}</span><span class="s2">.pickle&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grant</span> <span class="ow">is</span> <span class="n">Grant</span><span class="o">.</span><span class="n">CLIENT_CREDENTIALS</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scopes</span> <span class="o">!=</span> <span class="p">[</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`scopes` must be [&#39;public&#39;] if the &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;client credentials grant is used. Got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">scopes</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grant</span> <span class="ow">is</span> <span class="n">Grant</span><span class="o">.</span><span class="n">AUTHORIZATION_CODE</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">redirect_uri</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`redirect_uri` must be passed if the &quot;</span>
                <span class="s2">&quot;authorization code grant is used.&quot;</span><span class="p">)</span>

        <span class="n">token</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">access_token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># allow refresh_token to be null for the case of client credentials</span>
            <span class="c1"># grant from access token, which does not have an associated refresh</span>
            <span class="c1"># token.</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;token_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Bearer&quot;</span><span class="p">,</span>
                <span class="s2">&quot;access_token&quot;</span><span class="p">:</span> <span class="n">access_token</span><span class="p">,</span>
                <span class="s2">&quot;refresh_token&quot;</span><span class="p">:</span> <span class="n">refresh_token</span>
            <span class="p">}</span>
            <span class="n">token</span> <span class="o">=</span> <span class="n">OAuth2Token</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">authenticate</span><span class="p">(</span><span class="n">token</span><span class="o">=</span><span class="n">token</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">gen_token_key</span><span class="p">(</span><span class="n">grant</span><span class="p">,</span> <span class="n">client_id</span><span class="p">,</span> <span class="n">client_secret</span><span class="p">,</span> <span class="n">scopes</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The unique key / hash for the given set of parameters. This is intended</span>
<span class="sd">        to provide a way to allow multiple OssapiV2&#39;s to live at the same time,</span>
<span class="sd">        by eg saving their tokens to different files based on their key.</span>

<span class="sd">        This function is also deterministic, to eg allow tokens to be reused if</span>
<span class="sd">        OssapiV2 is instantiated twice with the same parameters. This avoids the</span>
<span class="sd">        need to reauthenticate unless absolutely necessary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">grant</span> <span class="o">=</span> <span class="n">Grant</span><span class="p">(</span><span class="n">grant</span><span class="p">)</span>
        <span class="n">scopes</span> <span class="o">=</span> <span class="p">[</span><span class="n">Scope</span><span class="p">(</span><span class="n">scope</span><span class="p">)</span> <span class="k">for</span> <span class="n">scope</span> <span class="ow">in</span> <span class="n">scopes</span><span class="p">]</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">()</span>
        <span class="n">m</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">grant</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
        <span class="n">m</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">client_id</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
        <span class="n">m</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">client_secret</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">scope</span> <span class="ow">in</span> <span class="n">scopes</span><span class="p">:</span>
            <span class="n">m</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">scope</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">remove_token</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">token_directory</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes the token file associated with the given key. If</span>
<span class="sd">        ``token_directory`` is passed, looks there for the token file instead of</span>
<span class="sd">        locally in ossapi&#39;s install site.</span>

<span class="sd">        To determine the key associated with a given grant, client_id,</span>
<span class="sd">        client_secret, and set of scopes, use ``gen_token_key``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">token_directory</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">Path</span><span class="p">(</span><span class="n">token_directory</span><span class="p">)</span> <span class="k">if</span> <span class="n">token_directory</span> <span class="k">else</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span>
        <span class="p">)</span>
        <span class="n">token_file</span> <span class="o">=</span> <span class="n">token_directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">.pickle&quot;</span>
        <span class="n">token_file</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">authenticate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a valid OAuth2Session, either from a saved token file associated</span>
<span class="sd">        with this OssapiV2&#39;s parameters, or from a fresh authentication if no</span>
<span class="sd">        such file exists.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">token_file</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">or</span> <span class="n">token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">token</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">token_file</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">token</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grant</span> <span class="ow">is</span> <span class="n">Grant</span><span class="o">.</span><span class="n">CLIENT_CREDENTIALS</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">OAuth2Session</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client_id</span><span class="p">,</span> <span class="n">token</span><span class="o">=</span><span class="n">token</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grant</span> <span class="ow">is</span> <span class="n">Grant</span><span class="o">.</span><span class="n">AUTHORIZATION_CODE</span><span class="p">:</span>
                <span class="n">auto_refresh_kwargs</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;client_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span><span class="p">,</span>
                    <span class="s2">&quot;client_secret&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_secret</span>
                <span class="p">}</span>
                <span class="k">return</span> <span class="n">OAuth2Session</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client_id</span><span class="p">,</span> <span class="n">token</span><span class="o">=</span><span class="n">token</span><span class="p">,</span>
                    <span class="n">redirect_uri</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">redirect_uri</span><span class="p">,</span>
                    <span class="n">auto_refresh_url</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">TOKEN_URL</span><span class="p">,</span>
                    <span class="n">auto_refresh_kwargs</span><span class="o">=</span><span class="n">auto_refresh_kwargs</span><span class="p">,</span>
                    <span class="n">token_updater</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_save_token</span><span class="p">,</span>
                    <span class="n">scope</span><span class="o">=</span><span class="p">[</span><span class="n">scope</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">scope</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scopes</span><span class="p">])</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grant</span> <span class="ow">is</span> <span class="n">Grant</span><span class="o">.</span><span class="n">CLIENT_CREDENTIALS</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_new_client_grant</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_secret</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_new_authorization_grant</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_secret</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">redirect_uri</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scopes</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_new_client_grant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client_id</span><span class="p">,</span> <span class="n">client_secret</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Authenticates with the api from scratch on the client grant.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;initializing client credentials grant&quot;</span><span class="p">)</span>
        <span class="n">client</span> <span class="o">=</span> <span class="n">BackendApplicationClient</span><span class="p">(</span><span class="n">client_id</span><span class="o">=</span><span class="n">client_id</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;public&quot;</span><span class="p">])</span>
        <span class="n">session</span> <span class="o">=</span> <span class="n">OAuth2Session</span><span class="p">(</span><span class="n">client</span><span class="o">=</span><span class="n">client</span><span class="p">)</span>
        <span class="n">token</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">fetch_token</span><span class="p">(</span><span class="n">token_url</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">TOKEN_URL</span><span class="p">,</span>
            <span class="n">client_id</span><span class="o">=</span><span class="n">client_id</span><span class="p">,</span> <span class="n">client_secret</span><span class="o">=</span><span class="n">client_secret</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_save_token</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">session</span>

    <span class="k">def</span> <span class="nf">_new_authorization_grant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client_id</span><span class="p">,</span> <span class="n">client_secret</span><span class="p">,</span> <span class="n">redirect_uri</span><span class="p">,</span>
        <span class="n">scopes</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Authenticates with the api from scratch on the authorization code grant.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;initializing authorization code&quot;</span><span class="p">)</span>

        <span class="n">auto_refresh_kwargs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;client_id&quot;</span><span class="p">:</span> <span class="n">client_id</span><span class="p">,</span>
            <span class="s2">&quot;client_secret&quot;</span><span class="p">:</span> <span class="n">client_secret</span>
        <span class="p">}</span>
        <span class="n">session</span> <span class="o">=</span> <span class="n">OAuth2Session</span><span class="p">(</span><span class="n">client_id</span><span class="p">,</span> <span class="n">redirect_uri</span><span class="o">=</span><span class="n">redirect_uri</span><span class="p">,</span>
            <span class="n">auto_refresh_url</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">TOKEN_URL</span><span class="p">,</span>
            <span class="n">auto_refresh_kwargs</span><span class="o">=</span><span class="n">auto_refresh_kwargs</span><span class="p">,</span>
            <span class="n">token_updater</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_save_token</span><span class="p">,</span>
            <span class="n">scope</span><span class="o">=</span><span class="p">[</span><span class="n">scope</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">scope</span> <span class="ow">in</span> <span class="n">scopes</span><span class="p">])</span>

        <span class="n">authorization_url</span><span class="p">,</span> <span class="n">_state</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">session</span><span class="o">.</span><span class="n">authorization_url</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AUTH_CODE_URL</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">authorization_url</span><span class="p">)</span>

        <span class="c1"># open up a temporary socket so we can receive the GET request to the</span>
        <span class="c1"># callback url</span>
        <span class="n">port</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">redirect_uri</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">serversocket</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
        <span class="n">serversocket</span><span class="o">.</span><span class="n">bind</span><span class="p">((</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
        <span class="n">serversocket</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">connection</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">serversocket</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="c1"># arbitrary &quot;large enough&quot; byte receive size</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">connection</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">8192</span><span class="p">))</span>
        <span class="n">connection</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;HTTP/1.0 200 OK</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">connection</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;Content-Type: text/html</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">connection</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">connection</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;&quot;&quot;&lt;html&gt;&lt;body&gt;</span>
<span class="s2">            &lt;h2&gt;Ossapi has received your authentication.&lt;/h2&gt; You</span>
<span class="s2">            may now close this tab safely.</span>
<span class="s2">            &lt;/body&gt;&lt;/html&gt;</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="n">connection</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">serversocket</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">code</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;code=&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&amp;state=&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">token</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">fetch_token</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TOKEN_URL</span><span class="p">,</span> <span class="n">client_id</span><span class="o">=</span><span class="n">client_id</span><span class="p">,</span>
            <span class="n">client_secret</span><span class="o">=</span><span class="n">client_secret</span><span class="p">,</span> <span class="n">code</span><span class="o">=</span><span class="n">code</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_token</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">session</span>

    <span class="k">def</span> <span class="nf">_save_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves the token to this OssapiV2&#39;s associated token file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;saving token to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">token_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">token_file</span><span class="p">,</span> <span class="s2">&quot;wb+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{},</span> <span class="n">data</span><span class="o">=</span><span class="p">{}):</span>
        <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_params</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="c1"># also format data for post requests</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_params</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">BASE_URL</span><span class="si">}{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">TokenExpiredError</span><span class="p">:</span>
            <span class="c1"># provide &quot;auto refreshing&quot; for client credentials grant. The client</span>
            <span class="c1"># grant doesn&#39;t actually provide a refresh token, so we can&#39;t hook</span>
            <span class="c1"># onto OAuth2Session&#39;s auto_refresh functionality like we do for the</span>
            <span class="c1"># authorization code grant. But we can do something effectively</span>
            <span class="c1"># equivalent: whenever we make a request with an expired client</span>
            <span class="c1"># grant token, just request a new one.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grant</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">Grant</span><span class="o">.</span><span class="n">CLIENT_CREDENTIALS</span><span class="p">:</span>
                <span class="k">raise</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_new_client_grant</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client_id</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">client_secret</span><span class="p">)</span>
            <span class="c1"># redo the request now that we have a valid token</span>
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">BASE_URL</span><span class="si">}{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;made </span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2"> request to </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="si">}</span><span class="s2">, data </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">json_</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;received json: </span><span class="se">\n</span><span class="si">{</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">json_</span><span class="p">,</span><span class="w"> </span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_response</span><span class="p">(</span><span class="n">json_</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instantiate_type</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span> <span class="n">json_</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_</span><span class="p">,</span> <span class="n">url</span><span class="p">):</span>
        <span class="c1"># TODO this should just be `if &quot;error&quot; in json`, but for some reason</span>
        <span class="c1"># `self.search_beatmaps` always returns an error in the response...</span>
        <span class="c1"># open an issue on osu-web?</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">json_</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="s2">&quot;error&quot;</span> <span class="ow">in</span> <span class="n">json_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;api returned an error of `</span><span class="si">{</span><span class="n">json_</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">` for &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;a request to </span><span class="si">{</span><span class="n">unquote</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{}):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span> <span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_post</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{}):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{}):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span> <span class="s2">&quot;PUT&quot;</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_format_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="c1"># we need to pass multiple values for this key, so make its</span>
                <span class="c1"># value a list https://stackoverflow.com/a/62042144</span>
                <span class="n">params</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">[]&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                    <span class="n">params</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">[]&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_format_value</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
                <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Cursor</span><span class="p">):</span>
                <span class="n">new_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_params</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">new_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">params</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;cursor[</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
                <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Mod</span><span class="p">):</span>
                <span class="n">params</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">[]&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span>
                <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">params</span>

    <span class="k">def</span> <span class="nf">_format_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">datetime</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">1000</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">timestamp</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">value</span><span class="o">.</span><span class="n">value</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;true&quot;</span> <span class="k">if</span> <span class="nb">bool</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="s2">&quot;false&quot;</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">_resolve_annotations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is where the magic happens. Since python lacks a good</span>
<span class="sd">        deserialization library, I&#39;ve opted to use type annotations and type</span>
<span class="sd">        annotations only to convert json to objects. A breakdown follows.</span>

<span class="sd">        Every endpoint defines a base object, let&#39;s say it&#39;s a ``Score``. We</span>
<span class="sd">        first instantiate this object with the json we received. This is easy to</span>
<span class="sd">        do because (almost) all of our objects are dataclasses, which means we</span>
<span class="sd">        can pass the json as ``Score(**json)`` and since the names of our fields</span>
<span class="sd">        coincide with the names of the api json keys, everything works.</span>

<span class="sd">        This populates all of the surface level members, but nested attributes</span>
<span class="sd">        which are annotated as another dataclass object will still be dicts. So</span>
<span class="sd">        we traverse down the tree of our base object&#39;s attributes (depth-first,</span>
<span class="sd">        though I&#39;m pretty sure BFS would work just as well), looking for any</span>
<span class="sd">        attribute with a type annotation that we need to deal with. For</span>
<span class="sd">        instance, ``Score`` has a ``beatmap`` attribute, which is annotated as</span>
<span class="sd">        ``Optional[Beatmap]``. We ignore the optional annotation (since we&#39;re</span>
<span class="sd">        looking at this attribute, we must have received data for it, so it&#39;s</span>
<span class="sd">        nonnull) and then instantiate the ``beatmap`` attribute the same way</span>
<span class="sd">        we instantiated the ``Score`` - with ``Beatmap(**json)``. Of course, the</span>
<span class="sd">        variables will look different in the method (``type_(**value)``).</span>

<span class="sd">        Finally, when traversing the attribute tree, we also look for attributes</span>
<span class="sd">        which aren&#39;t dataclasses, but we still need to convert. For instance,</span>
<span class="sd">        any attribute with an annotation of ``datetime`` or ``Mod`` we convert</span>
<span class="sd">        to a ``datetime`` and ``Mod`` object respectively.</span>

<span class="sd">        This code is arguably trying to be too smart for its own good, but I</span>
<span class="sd">        think it&#39;s very elegant from the perspective of &quot;just add a dataclass</span>
<span class="sd">        that mirrors the api&#39;s objects and everything works&quot;. Will hopefully</span>
<span class="sd">        make changing our dataclasses to account for breaking api changes in</span>
<span class="sd">        the future trivial as well.</span>

<span class="sd">        And if I&#39;m being honest, it was an excuse to learn the internals of</span>
<span class="sd">        python&#39;s typing system.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># we want to get the annotations of inherited members as well, which is</span>
        <span class="c1"># why we pass `type(obj)` instead of just `obj`, which would only</span>
        <span class="c1"># return annotations for attributes defined in `obj` and not its</span>
        <span class="c1"># inherited attributes.</span>
        <span class="n">annotations</span> <span class="o">=</span> <span class="n">get_type_hints</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
        <span class="n">override_annotations</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">override_types</span><span class="p">()</span>
        <span class="n">annotations</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">annotations</span><span class="p">,</span> <span class="o">**</span><span class="n">override_annotations</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;resolving annotations for type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">attr</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># we use this attribute later if we encounter an attribute which</span>
            <span class="c1"># has been instantiated generically, but we don&#39;t need to do</span>
            <span class="c1"># anything with it now.</span>
            <span class="k">if</span> <span class="n">attr</span> <span class="o">==</span> <span class="s2">&quot;__orig_class__&quot;</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">type_</span> <span class="o">=</span> <span class="n">annotations</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span>
            <span class="c1"># when we instantiate types, we explicitly fill in optional</span>
            <span class="c1"># attributes with `None`. We want to skip these, but only if the</span>
            <span class="c1"># attribute is actually annotated as optional, otherwise we would be</span>
            <span class="c1"># skipping fields that are null which aren&#39;t supposed to be, and</span>
            <span class="c1"># prevent that error from being caught.</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">is_optional</span><span class="p">(</span><span class="n">type_</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;resolving attribute </span><span class="si">{</span><span class="n">attr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instantiate_type</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">attr_name</span><span class="o">=</span><span class="n">attr</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;resolved annotations for type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="k">def</span> <span class="nf">_instantiate_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attr_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># `attr_name` is purely for debugging, it&#39;s the name of the attribute</span>
        <span class="c1"># being instantiated</span>
        <span class="n">origin</span> <span class="o">=</span> <span class="n">get_origin</span><span class="p">(</span><span class="n">type_</span><span class="p">)</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">get_args</span><span class="p">(</span><span class="n">type_</span><span class="p">)</span>

        <span class="c1"># if this type is an optional, &quot;unwrap&quot; it to get the true type.</span>
        <span class="c1"># We don&#39;t care about the optional annotation in this context</span>
        <span class="c1"># because if we got here that means we were passed a value for this</span>
        <span class="c1"># attribute, so we know it&#39;s defined and not optional.</span>
        <span class="k">if</span> <span class="n">is_optional</span><span class="p">(</span><span class="n">type_</span><span class="p">):</span>
            <span class="c1"># leaving these assertions in to help me catch errors in my</span>
            <span class="c1"># reasoning until I better understand python&#39;s typing.</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
            <span class="n">type_</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">origin</span> <span class="o">=</span> <span class="n">get_origin</span><span class="p">(</span><span class="n">type_</span><span class="p">)</span>
            <span class="n">args</span> <span class="o">=</span> <span class="n">get_args</span><span class="p">(</span><span class="n">type_</span><span class="p">)</span>

        <span class="c1"># validate that the values we&#39;re receiving are the types we expect them</span>
        <span class="c1"># to be</span>
        <span class="k">def</span> <span class="nf">_check_primitive_type</span><span class="p">():</span>
            <span class="c1"># The osu api occasionally makes attributes optional, so allow null</span>
            <span class="c1"># values even for non-optional fields if we&#39;re not in</span>
            <span class="c1"># strict mode.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">strict</span> <span class="ow">and</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_compatible_type</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">type_</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;expected type </span><span class="si">{</span><span class="n">type_</span><span class="si">}</span><span class="s2"> for value </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">, got &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot; (for attribute: </span><span class="si">{</span><span class="n">attr_name</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">if</span> <span class="n">attr_name</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_primitive_type</span><span class="p">(</span><span class="n">type_</span><span class="p">):</span>
            <span class="n">_check_primitive_type</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">is_base_model_type</span><span class="p">(</span><span class="n">type_</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;instantiating base type </span><span class="si">{</span><span class="n">type_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">type_</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">origin</span> <span class="ow">is</span> <span class="nb">list</span> <span class="ow">and</span> <span class="p">(</span><span class="n">is_model_type</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">or</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">TypeVar</span><span class="p">)):</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
            <span class="c1"># check if the list has been instantiated generically; if so,</span>
            <span class="c1"># use the concrete type backing the generic type.</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">TypeVar</span><span class="p">):</span>
                <span class="c1"># `__orig_class__` is how we can get the concrete type of</span>
                <span class="c1"># a generic. See https://stackoverflow.com/a/60984681 and</span>
                <span class="c1"># https://www.python.org/dev/peps/pep-0560/#mro-entries.</span>
                <span class="n">type_</span> <span class="o">=</span> <span class="n">get_args</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">__orig_class__</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1"># otherwise, it&#39;s been instantiated with a concrete model type,</span>
            <span class="c1"># so use that type.</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">type_</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">new_value</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">is_base_model_type</span><span class="p">(</span><span class="n">type_</span><span class="p">):</span>
                    <span class="n">entry</span> <span class="o">=</span> <span class="n">type_</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instantiate</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span>
                <span class="c1"># if the list entry is a high (non-base) model type, we need to</span>
                <span class="c1"># resolve it instead of just sticking it into the list, since</span>
                <span class="c1"># its children might still be dicts and not model instances.</span>
                <span class="c1"># We don&#39;t do this for base types because that type is the one</span>
                <span class="c1"># responsible for resolving its own annotations or doing</span>
                <span class="c1"># whatever else it needs to do, not us.</span>
                <span class="k">if</span> <span class="n">is_high_model_type</span><span class="p">(</span><span class="n">type_</span><span class="p">):</span>
                    <span class="n">entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_annotations</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
                <span class="n">new_value</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">new_value</span>

        <span class="c1"># either we ourself are a model type (eg `Search`), or we are</span>
        <span class="c1"># a special indexed type (eg `type_ == SearchResult[UserCompact]`,</span>
        <span class="c1"># `origin == UserCompact`). In either case we want to instantiate</span>
        <span class="c1"># `type_`.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_model_type</span><span class="p">(</span><span class="n">type_</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_model_type</span><span class="p">(</span><span class="n">origin</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instantiate</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="c1"># we need to resolve the annotations of any nested model types before we</span>
        <span class="c1"># set the attribute. This recursion is well-defined because the base</span>
        <span class="c1"># case is when `value` has no model types, which will always happen</span>
        <span class="c1"># eventually.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_annotations</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_instantiate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;instantiating type </span><span class="si">{</span><span class="n">type_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">kwargs</span> <span class="o">=</span> <span class="n">type_</span><span class="o">.</span><span class="n">preprocess_data</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">override_type</span> <span class="o">=</span> <span class="n">type_</span><span class="o">.</span><span class="n">override_class</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">type_</span> <span class="o">=</span> <span class="n">override_type</span> <span class="ow">or</span> <span class="n">type_</span>
        <span class="n">signature_type</span> <span class="o">=</span> <span class="n">type_</span>

        <span class="c1"># we need a special case to handle when `type_` is a</span>
        <span class="c1"># `_GenericAlias`. I don&#39;t fully understand why this exception is</span>
        <span class="c1"># necessary, and it&#39;s likely the result of some error on my part in our</span>
        <span class="c1"># type handling code. Nevertheless, until I dig more deeply into it,</span>
        <span class="c1"># we need to extract the type to use for the init signature and the type</span>
        <span class="c1"># hints from a `_GenericAlias` if we see one, as standard methods</span>
        <span class="c1"># won&#39;t work.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">type_hints</span> <span class="o">=</span> <span class="n">get_type_hints</span><span class="p">(</span><span class="n">type_</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">type_</span><span class="p">)</span> <span class="ow">is</span> <span class="n">_GenericAlias</span> <span class="c1"># pylint: disable=unidiomatic-typecheck</span>

            <span class="n">signature_type</span> <span class="o">=</span> <span class="n">get_origin</span><span class="p">(</span><span class="n">type_</span><span class="p">)</span>
            <span class="n">type_hints</span> <span class="o">=</span> <span class="n">get_type_hints</span><span class="p">(</span><span class="n">signature_type</span><span class="p">)</span>

        <span class="n">field_names</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">type_hints</span><span class="p">:</span>
            <span class="c1"># any inherited attributes will be present in the annotations</span>
            <span class="c1"># (type_hints) but not actually an attribute of the type. Just skip</span>
            <span class="c1"># them for now. TODO I&#39;m pretty sure this is going to cause issues</span>
            <span class="c1"># if we ever have a field on a model and then another model</span>
            <span class="c1"># inheriting from it; the inheriting model won&#39;t have the field</span>
            <span class="c1"># picked up here and the override name won&#39;t come into play.</span>
            <span class="c1"># probably just traverse the mro?</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Field</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="n">field_names</span><span class="p">[</span><span class="n">value</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span>

        <span class="c1"># make a copy so we can modify while iterating</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">field_names</span><span class="p">:</span>
                <span class="n">key</span> <span class="o">=</span> <span class="n">field_names</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="c1"># if we&#39;ve annotated a class with `Optional[X]`, and the api response</span>
        <span class="c1"># didn&#39;t return a value for that attribute, pass `None` for that</span>
        <span class="c1"># attribute.</span>
        <span class="c1"># This is so that we don&#39;t have to define a default value of `None`</span>
        <span class="c1"># for each optional attribute of our models, since the default will</span>
        <span class="c1"># always be `None`.</span>
        <span class="k">for</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">annotation</span> <span class="ow">in</span> <span class="n">type_hints</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">is_optional</span><span class="p">(</span><span class="n">annotation</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">attribute</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                    <span class="n">kwargs</span><span class="p">[</span><span class="n">attribute</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># The osu api often adds new fields to various models, and these are not</span>
        <span class="c1"># considered breaking changes. To make this a non-breaking change on our</span>
        <span class="c1"># end as well, we ignore any unexpected parameters, unless</span>
        <span class="c1"># `self.strict` is `True`. This means that consumers using old</span>
        <span class="c1"># ossapi versions (which aren&#39;t up to date with the latest parameters</span>
        <span class="c1"># list) will have new fields silently ignored instead of erroring.</span>
        <span class="c1"># This also means that consumers won&#39;t be able to benefit from new</span>
        <span class="c1"># fields unless they upgrade, but this is a conscious decision on our</span>
        <span class="c1"># part to keep things entirely statically typed. Otherwise we would be</span>
        <span class="c1"># going the route of PRAW, which returns dynamic results for all api</span>
        <span class="c1"># queries. I think a statically typed solution is better for the osu!</span>
        <span class="c1"># api, which promises at least some level of stability in its api.</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">signature_type</span><span class="o">.</span><span class="fm">__init__</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span>
        <span class="n">kwargs_</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">:</span>
                <span class="n">kwargs_</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unexpected parameter `</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">` for type &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">type_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ignoring unexpected parameter `</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">` from &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;api response for type </span><span class="si">{</span><span class="n">type_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># every model gets a special `_api` parameter, which is the</span>
        <span class="c1"># `OssapiV2` instance which loaded it (aka us).</span>
        <span class="n">kwargs_</span><span class="p">[</span><span class="s2">&quot;_api&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">type_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs_</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;type error while instantiating class </span><span class="si">{</span><span class="n">type_</span><span class="si">}</span><span class="s2">: &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>

        <span class="k">return</span> <span class="n">val</span>


    <span class="c1"># =========</span>
    <span class="c1"># Endpoints</span>
    <span class="c1"># =========</span>


    <span class="c1"># /beatmaps</span>
    <span class="c1"># ---------</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;beatmaps&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">beatmap_user_score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">beatmap_id</span><span class="p">:</span> <span class="n">BeatmapIdT</span><span class="p">,</span>
        <span class="n">user_id</span><span class="p">:</span> <span class="n">UserIdT</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">mode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">GameModeT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">mods</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ModT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BeatmapUserScore</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a user&#39;s best score on a beatmap. If you want to retrieve all</span>
<span class="sd">        scores, see :meth:`beatmap_user_scores`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        beatmap_id</span>
<span class="sd">            The beatmap the score was set on.</span>
<span class="sd">        user_id</span>
<span class="sd">            The user who set the score.</span>
<span class="sd">        mode</span>
<span class="sd">            The mode the scores were set on.</span>
<span class="sd">        mods</span>
<span class="sd">            The mods the score was set with.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `User Beatmap Score</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#get-a-user-beatmap-score&gt;`__</span>
<span class="sd">        endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="n">mode</span><span class="p">,</span> <span class="s2">&quot;mods&quot;</span><span class="p">:</span> <span class="n">mods</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">BeatmapUserScore</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;/beatmaps/</span><span class="si">{</span><span class="n">beatmap_id</span><span class="si">}</span><span class="s2">/scores/users/</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;beatmaps&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">beatmap_user_scores</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">beatmap_id</span><span class="p">:</span> <span class="n">BeatmapIdT</span><span class="p">,</span>
        <span class="n">user_id</span><span class="p">:</span> <span class="n">UserIdT</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">mode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">GameModeT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">BeatmapUserScore</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get all of a user&#39;s scores on a beatmap. If you only want the top user</span>
<span class="sd">        score, see :meth:`beatmap_user_score`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        beatmap_id</span>
<span class="sd">            The beatmap the scores were set on.</span>
<span class="sd">        user_id</span>
<span class="sd">            The user who set the scores.</span>
<span class="sd">        mode</span>
<span class="sd">            The mode the scores were set on.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements to `User Beatmap Scores</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#get-a-user-beatmap-scores&gt;`__</span>
<span class="sd">        endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="n">mode</span><span class="p">}</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">BeatmapUserScores</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;/beatmaps/</span><span class="si">{</span><span class="n">beatmap_id</span><span class="si">}</span><span class="s2">/scores/users/</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">/all&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">scores</span><span class="o">.</span><span class="n">scores</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;beatmaps&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">beatmap_scores</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">beatmap_id</span><span class="p">:</span> <span class="n">BeatmapIdT</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">mode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">GameModeT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">mods</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ModT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="nb">type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RankingTypeT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BeatmapScores</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the top scores of a beatmap.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        beatmap_id</span>
<span class="sd">            The beatmap to get scores of.</span>
<span class="sd">        mode</span>
<span class="sd">            The mode to get scores of.</span>
<span class="sd">        mods</span>
<span class="sd">            Get the top scores set with exactly these mods, if passed.</span>
<span class="sd">        type</span>
<span class="sd">            How to order the scores. Defaults to ordering by score.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get Beatmap Scores</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#get-beatmap-scores&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="n">mode</span><span class="p">,</span> <span class="s2">&quot;mods&quot;</span><span class="p">:</span> <span class="n">mods</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">type</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">BeatmapScores</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;/beatmaps/</span><span class="si">{</span><span class="n">beatmap_id</span><span class="si">}</span><span class="s2">/scores&quot;</span><span class="p">,</span>
            <span class="n">params</span><span class="p">)</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;beatmaps&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">beatmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">beatmap_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BeatmapIdT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">checksum</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Beatmap</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a beatmap from an id, checksum, or filename.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        beatmap_id</span>
<span class="sd">            The id of the beatmap.</span>
<span class="sd">        checksum</span>
<span class="sd">            The md5 hash of the beatmap.</span>
<span class="sd">        filename</span>
<span class="sd">            The filename of the beatmap.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Combines the</span>
<span class="sd">        `Get Beatmap &lt;https://osu.ppy.sh/docs/index.html#get-beatmapL&gt;`_ and</span>
<span class="sd">        `Lookup Beatmap &lt;https://osu.ppy.sh/docs/index.html#lookup-beatmap&gt;`_</span>
<span class="sd">        endpoints.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">beatmap_id</span> <span class="ow">or</span> <span class="n">checksum</span> <span class="ow">or</span> <span class="n">filename</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;at least one of beatmap_id, checksum, or &quot;</span>
                <span class="s2">&quot;filename must be passed&quot;</span><span class="p">)</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;checksum&quot;</span><span class="p">:</span> <span class="n">checksum</span><span class="p">,</span> <span class="s2">&quot;filename&quot;</span><span class="p">:</span> <span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">beatmap_id</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">Beatmap</span><span class="p">,</span> <span class="s2">&quot;/beatmaps/lookup&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;beatmaps&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">beatmaps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">beatmap_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">BeatmapIdT</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Beatmap</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Batch get beatmaps by id. If you only want to retrieve a single beatmap,</span>
<span class="sd">        or want to retrieve beatmaps by something other than id (eg checksum),</span>
<span class="sd">        see :meth:`beatmap`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        beatmap_ids</span>
<span class="sd">            The beatmaps to get.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get Beatmaps</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#get-beatmaps&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ids&quot;</span><span class="p">:</span> <span class="n">beatmap_ids</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">Beatmaps</span><span class="p">,</span> <span class="s2">&quot;/beatmaps&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span><span class="o">.</span><span class="n">beatmaps</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;beatmaps&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">beatmap_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">beatmap_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">mods</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ModT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">ruleset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">GameModeT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">ruleset_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DifficultyAttributes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the difficult attributes of a beatmap. Used for pp calculation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        beatmap_id</span>
<span class="sd">            The beatmap to get the difficulty attributes of.</span>
<span class="sd">        mods</span>
<span class="sd">            The mods to calculate difficulty attributes with.</span>
<span class="sd">        ruleset</span>
<span class="sd">            The ruleset (gamemode) to calculate difficulty attributes of.</span>
<span class="sd">        ruleset_id</span>
<span class="sd">            Alternative parameter to ruleset which takes an integer (ruleset id)</span>
<span class="sd">            instead of a string (ruleset name).</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get Beatmap Attributes</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#get-beatmap-attributes&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;mods&quot;</span><span class="p">:</span> <span class="n">mods</span><span class="p">,</span> <span class="s2">&quot;ruleset&quot;</span><span class="p">:</span> <span class="n">ruleset</span><span class="p">,</span> <span class="s2">&quot;ruleset_id&quot;</span><span class="p">:</span> <span class="n">ruleset_id</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="n">DifficultyAttributes</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;/beatmaps/</span><span class="si">{</span><span class="n">beatmap_id</span><span class="si">}</span><span class="s2">/attributes&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>


    <span class="c1"># /beatmapsets</span>
    <span class="c1"># ------------</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;beatmapsets&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">beatmapset_discussion_posts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">beatmapset_discussion_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">limit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">page</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sort</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BeatmapDiscussionPostSortT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">user_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UserIdT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">with_deleted</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BeatmapsetDiscussionPosts</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the posts of a beatmapset discussion.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        beatmapset_discussion_id</span>
<span class="sd">            The beatmapset discussion to get the posts of.</span>
<span class="sd">        limit</span>
<span class="sd">            Maximum number of posts to return.</span>
<span class="sd">        page</span>
<span class="sd">            Pagination for results.</span>
<span class="sd">        sort</span>
<span class="sd">            How to sort the posts.</span>
<span class="sd">        user_id</span>

<span class="sd">        with_deleted</span>
<span class="sd">            Whether to include deleted posts. Currently has no effect even if</span>
<span class="sd">            you are a gmt/admin.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get Beatmapset Discussion Posts</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#get-beatmapset-discussion-posts&gt;`__</span>
<span class="sd">        endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;beatmapset_discussion_id&quot;</span><span class="p">:</span> <span class="n">beatmapset_discussion_id</span><span class="p">,</span>
            <span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="n">limit</span><span class="p">,</span> <span class="s2">&quot;page&quot;</span><span class="p">:</span> <span class="n">page</span><span class="p">,</span> <span class="s2">&quot;sort&quot;</span><span class="p">:</span> <span class="n">sort</span><span class="p">,</span> <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="n">user_id</span><span class="p">,</span>
            <span class="s2">&quot;with_deleted&quot;</span><span class="p">:</span> <span class="n">with_deleted</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">BeatmapsetDiscussionPosts</span><span class="p">,</span>
            <span class="s2">&quot;/beatmapsets/discussions/posts&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;beatmapsets&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">beatmapset_discussion_votes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">beatmapset_discussion_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">limit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">page</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">receiver_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">vote</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BeatmapsetDiscussionVoteT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sort</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BeatmapsetDiscussionVoteSortT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">user_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UserIdT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">with_deleted</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BeatmapsetDiscussionVotes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get beatmapset discussion votes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        beatmapset_discussion_id</span>
<span class="sd">            Filter by a beatmapset discussion.</span>
<span class="sd">        limit</span>
<span class="sd">            Maximum number of votes to return.</span>
<span class="sd">        page</span>
<span class="sd">            Pagination for results.</span>
<span class="sd">        receiver_id</span>
<span class="sd">            Filter by the user receiving the votes.</span>
<span class="sd">        vote</span>
<span class="sd">            Specify to return either only upvotes or only downvotes.</span>
<span class="sd">        sort</span>
<span class="sd">            How to sort the votes.</span>
<span class="sd">        user_id</span>
<span class="sd">            Filter by the user giving the votes.</span>
<span class="sd">        with_deleted</span>
<span class="sd">            Whether to include deleted posts. Currently has no effect even if</span>
<span class="sd">            you are a gmt/admin.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get Beatmapset Discussion Posts</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#get-beatmapset-discussion-posts&gt;`__</span>
<span class="sd">        endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;beatmapset_discussion_id&quot;</span><span class="p">:</span> <span class="n">beatmapset_discussion_id</span><span class="p">,</span>
            <span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="n">limit</span><span class="p">,</span> <span class="s2">&quot;page&quot;</span><span class="p">:</span> <span class="n">page</span><span class="p">,</span> <span class="s2">&quot;receiver&quot;</span><span class="p">:</span> <span class="n">receiver_id</span><span class="p">,</span>
            <span class="s2">&quot;score&quot;</span><span class="p">:</span> <span class="n">vote</span><span class="p">,</span> <span class="s2">&quot;sort&quot;</span><span class="p">:</span> <span class="n">sort</span><span class="p">,</span> <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="n">user_id</span><span class="p">,</span>
            <span class="s2">&quot;with_deleted&quot;</span><span class="p">:</span> <span class="n">with_deleted</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">BeatmapsetDiscussionVotes</span><span class="p">,</span>
            <span class="s2">&quot;/beatmapsets/discussions/votes&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;beatmapsets&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">beatmapset_discussions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">beatmapset_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BeatmapsetIdT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">beatmap_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BeatmapIdT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">beatmapset_status</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BeatmapsetStatusT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">limit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">message_types</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">MessageTypeT</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">only_unresolved</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">page</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sort</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BeatmapDiscussionPostSortT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">user_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UserIdT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">with_deleted</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BeatmapsetDiscussions</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get beatmapset discussions.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        beatmapset_id</span>
<span class="sd">            Filter by a beatmapset.</span>
<span class="sd">        beatmap_id</span>
<span class="sd">            Filter by a beatmap.</span>
<span class="sd">        beatmapset_status</span>
<span class="sd">            Filter by a category of beatmapsets.</span>
<span class="sd">        limit</span>
<span class="sd">            Maximum number of discussions to return.</span>
<span class="sd">        message_types</span>
<span class="sd">            Filter by a discussion message type.</span>
<span class="sd">        only_unresolved</span>
<span class="sd">            ``True`` to only show unresolved issues. Defaults to ``False``.</span>
<span class="sd">        page</span>
<span class="sd">            Pagination for results.</span>
<span class="sd">        sort</span>
<span class="sd">            How to sort the discussions.</span>
<span class="sd">        user</span>
<span class="sd">            Filter by poster id.</span>
<span class="sd">        with_deleted</span>
<span class="sd">            Whether to include deleted posts. Currently has no effect even if</span>
<span class="sd">            you are a gmt/admin.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get Beatmapset Discussion Posts</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#get-beatmapset-discussion-posts&gt;`__</span>
<span class="sd">        endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;beatmapset_id&quot;</span><span class="p">:</span> <span class="n">beatmapset_id</span><span class="p">,</span> <span class="s2">&quot;beatmap_id&quot;</span><span class="p">:</span> <span class="n">beatmap_id</span><span class="p">,</span>
            <span class="s2">&quot;beatmapset_status&quot;</span><span class="p">:</span> <span class="n">beatmapset_status</span><span class="p">,</span> <span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="n">limit</span><span class="p">,</span>
            <span class="s2">&quot;message_types&quot;</span><span class="p">:</span> <span class="n">message_types</span><span class="p">,</span> <span class="s2">&quot;only_unresolved&quot;</span><span class="p">:</span> <span class="n">only_unresolved</span><span class="p">,</span>
            <span class="s2">&quot;page&quot;</span><span class="p">:</span> <span class="n">page</span><span class="p">,</span> <span class="s2">&quot;sort&quot;</span><span class="p">:</span> <span class="n">sort</span><span class="p">,</span> <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="n">user_id</span><span class="p">,</span>
            <span class="s2">&quot;with_deleted&quot;</span><span class="p">:</span> <span class="n">with_deleted</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">BeatmapsetDiscussions</span><span class="p">,</span>
            <span class="s2">&quot;/beatmapsets/discussions&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;beatmapsets&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">search_beatmapsets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">query</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">mode</span><span class="p">:</span> <span class="n">BeatmapsetSearchModeT</span> <span class="o">=</span> <span class="n">BeatmapsetSearchMode</span><span class="o">.</span><span class="n">ANY</span><span class="p">,</span>
        <span class="n">category</span><span class="p">:</span> <span class="n">BeatmapsetSearchCategoryT</span> <span class="o">=</span>
            <span class="n">BeatmapsetSearchCategory</span><span class="o">.</span><span class="n">HAS_LEADERBOARD</span><span class="p">,</span>
        <span class="n">explicit_content</span><span class="p">:</span> <span class="n">BeatmapsetSearchExplicitContentT</span> <span class="o">=</span>
            <span class="n">BeatmapsetSearchExplicitContent</span><span class="o">.</span><span class="n">HIDE</span><span class="p">,</span>
        <span class="n">genre</span><span class="p">:</span> <span class="n">BeatmapsetSearchGenreT</span> <span class="o">=</span> <span class="n">BeatmapsetSearchGenre</span><span class="o">.</span><span class="n">ANY</span><span class="p">,</span>
        <span class="n">language</span><span class="p">:</span> <span class="n">BeatmapsetSearchLanguageT</span> <span class="o">=</span> <span class="n">BeatmapsetSearchLanguage</span><span class="o">.</span><span class="n">ANY</span><span class="p">,</span>
        <span class="c1"># &quot;Extra&quot;</span>
        <span class="n">force_video</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">force_storyboard</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="c1"># &quot;General&quot;</span>
        <span class="n">force_recommended_difficulty</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">include_converts</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">force_followed_mappers</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">force_spotlights</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">force_featured_artists</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">cursor</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Cursor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sort</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BeatmapsetSearchSortT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BeatmapsetSearchResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Search beatmapsets. Equivalent to the beatmapset search page on the</span>
<span class="sd">        website (https://osu.ppy.sh/beatmapsets).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        query</span>
<span class="sd">            The search query. Can include filters like ``ranked&lt;2019``.</span>
<span class="sd">        mode</span>
<span class="sd">            Filter by mode.</span>
<span class="sd">        category</span>
<span class="sd">            Filter by category.</span>
<span class="sd">        explicit_content</span>
<span class="sd">            Whether to include beatmaps with explicit content.</span>
<span class="sd">        genre</span>
<span class="sd">            Filter by genre.</span>
<span class="sd">        language</span>
<span class="sd">            Filter by language.</span>
<span class="sd">        force_video</span>
<span class="sd">            ``True`` to only return beatmapsets with videos.</span>
<span class="sd">        force_storyboard</span>
<span class="sd">            ``True`` to only return beatmapsets with storyboards.</span>
<span class="sd">        force_recommended_difficulty</span>
<span class="sd">            ``True`` to filter by recommended difficulty.</span>
<span class="sd">        include_converts</span>
<span class="sd">            ``True`` to include converted beatmapsets.</span>
<span class="sd">        force_followed_mappers</span>
<span class="sd">            ``True`` to only return beatmapsets by mappers you follow.</span>
<span class="sd">        force_spotlights</span>
<span class="sd">            ``True`` to only return beatmapsets which have been in a spotlight.</span>
<span class="sd">        force_featured_artists</span>
<span class="sd">            ``True`` to only return beatmapsets by a featured artist.</span>
<span class="sd">        cursor</span>
<span class="sd">            Cursor for pagination.</span>
<span class="sd">        sort</span>
<span class="sd">            How to sort the beatmapsets.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Search Beatmapsets</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#beatmapsetssearchfilters&gt;`__</span>
<span class="sd">        endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Param key names are the same as https://osu.ppy.sh/beatmapsets,</span>
        <span class="c1"># so from eg https://osu.ppy.sh/beatmapsets?q=black&amp;s=any we get that</span>
        <span class="c1"># the query uses `q` and the category uses `s`.</span>

        <span class="n">explicit_content</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">BeatmapsetSearchExplicitContent</span><span class="o">.</span><span class="n">SHOW</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span><span class="p">,</span>
            <span class="n">BeatmapsetSearchExplicitContent</span><span class="o">.</span><span class="n">HIDE</span><span class="p">:</span> <span class="s2">&quot;false&quot;</span><span class="p">,</span>
        <span class="p">}[</span><span class="n">explicit_content</span><span class="p">]</span>

        <span class="n">extras</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">force_video</span><span class="p">:</span>
            <span class="n">extras</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;video&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">force_storyboard</span><span class="p">:</span>
            <span class="n">extras</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;storyboard&quot;</span><span class="p">)</span>
        <span class="n">extra</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">extras</span><span class="p">)</span>

        <span class="n">generals</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">force_recommended_difficulty</span><span class="p">:</span>
            <span class="n">generals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;recommended&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">include_converts</span><span class="p">:</span>
            <span class="n">generals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;converts&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">force_followed_mappers</span><span class="p">:</span>
            <span class="n">generals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;follows&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">force_spotlights</span><span class="p">:</span>
            <span class="n">generals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;spotlights&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">force_featured_artists</span><span class="p">:</span>
            <span class="n">generals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;featured_artists&quot;</span><span class="p">)</span>
        <span class="n">general</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">generals</span><span class="p">)</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cursor&quot;</span><span class="p">:</span> <span class="n">cursor</span><span class="p">,</span> <span class="s2">&quot;q&quot;</span><span class="p">:</span> <span class="n">query</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="n">category</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">:</span> <span class="n">mode</span><span class="p">,</span>
            <span class="s2">&quot;g&quot;</span><span class="p">:</span> <span class="n">genre</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">:</span> <span class="n">language</span><span class="p">,</span> <span class="s2">&quot;nsfw&quot;</span><span class="p">:</span> <span class="n">explicit_content</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">:</span> <span class="n">extra</span><span class="p">,</span>
            <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="n">general</span><span class="p">,</span> <span class="s2">&quot;sort&quot;</span><span class="p">:</span> <span class="n">sort</span><span class="p">}</span>

        <span class="c1"># BeatmapsetSearchGenre.ANY is the default and doesn&#39;t have a correct</span>
        <span class="c1"># corresponding value</span>
        <span class="k">if</span> <span class="n">genre</span> <span class="ow">is</span> <span class="n">BeatmapsetSearchGenre</span><span class="o">.</span><span class="n">ANY</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;g&quot;</span><span class="p">]</span>

        <span class="c1"># same for BeatmapsetSearchLanguage.ANY</span>
        <span class="k">if</span> <span class="n">language</span> <span class="ow">is</span> <span class="n">BeatmapsetSearchLanguage</span><span class="o">.</span><span class="n">ANY</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">BeatmapsetSearchResult</span><span class="p">,</span> <span class="s2">&quot;/beatmapsets/search/&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;beatmapsets&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">beatmapset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">beatmapset_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BeatmapsetIdT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">beatmap_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BeatmapIdT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Beatmapset</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a beatmapset from a beatmapset id or a beatmap id.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        beatmapset_id</span>
<span class="sd">            The beatmapset to get.</span>
<span class="sd">        beatmap_id</span>
<span class="sd">            Get the beatmapset associated with this beatmap.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Combines the `Get Beatmapset</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#beatmapsetsbeatmapset&gt;`__ and</span>
<span class="sd">        `Beatmapset Lookup</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#beatmapsetslookup&gt;`__ endpoints.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">beatmap_id</span><span class="p">)</span> <span class="o">^</span> <span class="nb">bool</span><span class="p">(</span><span class="n">beatmapset_id</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;exactly one of beatmap_id and beatmapset_id must &quot;</span>
                <span class="s2">&quot;be passed.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">beatmap_id</span><span class="p">:</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;beatmap_id&quot;</span><span class="p">:</span> <span class="n">beatmap_id</span><span class="p">}</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">Beatmapset</span><span class="p">,</span> <span class="s2">&quot;/beatmapsets/lookup&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">Beatmapset</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;/beatmapsets/</span><span class="si">{</span><span class="n">beatmapset_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;beatmapsets&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">beatmapset_events</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">limit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">page</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">user_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UserIdT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">types</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">BeatmapsetEventTypeT</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">min_date</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_date</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ModdingHistoryEventsBundle</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get beatmapset events. Equivalent to the events search page on the</span>
<span class="sd">        website (https://osu.ppy.sh/beatmapsets/events).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        limit</span>
<span class="sd">            Maximum number of events to return.</span>
<span class="sd">        page</span>
<span class="sd">            Pagination for events.</span>
<span class="sd">        user_id</span>
<span class="sd">            Filter by event author.</span>
<span class="sd">        types</span>
<span class="sd">            Filter by event type.</span>
<span class="sd">        min_date</span>
<span class="sd">            Filter by event date.</span>
<span class="sd">        max_date</span>
<span class="sd">            Filter by event date.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Beatmapset Events</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#beatmapsetsevents&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># limit is 5-50</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="n">limit</span><span class="p">,</span> <span class="s2">&quot;page&quot;</span><span class="p">:</span> <span class="n">page</span><span class="p">,</span> <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="n">user_id</span><span class="p">,</span>
            <span class="s2">&quot;min_date&quot;</span><span class="p">:</span> <span class="n">min_date</span><span class="p">,</span> <span class="s2">&quot;max_date&quot;</span><span class="p">:</span> <span class="n">max_date</span><span class="p">,</span> <span class="s2">&quot;types&quot;</span><span class="p">:</span> <span class="n">types</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">ModdingHistoryEventsBundle</span><span class="p">,</span> <span class="s2">&quot;/beatmapsets/events&quot;</span><span class="p">,</span>
            <span class="n">params</span><span class="p">)</span>


    <span class="c1"># /changelog</span>
    <span class="c1"># ----------</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;changelog&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">changelog_build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">stream</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">build</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Build</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get changelog build details.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        stream</span>
<span class="sd">            The changelog stream name (eg ``stable40``).</span>
<span class="sd">        build</span>
<span class="sd">            The changelog build name (eg ``20230121.1``)</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get Changelog Build</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#get-changelog-build&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">Build</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;/changelog/</span><span class="si">{</span><span class="n">stream</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">build</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;changelog&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">changelog_listing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">from_</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">to</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">stream</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">message_formats</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ChangelogMessageFormat</span><span class="p">]</span> <span class="o">=</span>
            <span class="p">[</span><span class="n">ChangelogMessageFormat</span><span class="o">.</span><span class="n">HTML</span><span class="p">,</span> <span class="n">ChangelogMessageFormat</span><span class="o">.</span><span class="n">MARKDOWN</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ChangelogListing</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get list of changelogs.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        from_</span>
<span class="sd">            Minimum build version.</span>
<span class="sd">        to</span>
<span class="sd">            Maximum build version.</span>
<span class="sd">        max_id</span>
<span class="sd">            Maximum build id.</span>
<span class="sd">        stream</span>
<span class="sd">            Filter changelogs by stream.</span>
<span class="sd">        message_formats</span>
<span class="sd">            Format to return text of changelog entries in.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get Changelog Listing</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#get-changelog-listing&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="n">from_</span><span class="p">,</span> <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="n">to</span><span class="p">,</span> <span class="s2">&quot;max_id&quot;</span><span class="p">:</span> <span class="n">max_id</span><span class="p">,</span> <span class="s2">&quot;stream&quot;</span><span class="p">:</span> <span class="n">stream</span><span class="p">,</span>
            <span class="s2">&quot;message_formats&quot;</span><span class="p">:</span> <span class="n">message_formats</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">ChangelogListing</span><span class="p">,</span> <span class="s2">&quot;/changelog&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

    <span class="c1"># TODO can almost certainly be combined with changelog_build endpoint, in</span>
    <span class="c1"># line with other get/lookup endpoint combinations (beatmap, beatmapset)</span>
    <span class="nd">@request</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;changelog&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">changelog_build_lookup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">changelog</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">message_formats</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ChangelogMessageFormat</span><span class="p">]</span> <span class="o">=</span>
            <span class="p">[</span><span class="n">ChangelogMessageFormat</span><span class="o">.</span><span class="n">HTML</span><span class="p">,</span> <span class="n">ChangelogMessageFormat</span><span class="o">.</span><span class="n">MARKDOWN</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Build</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Look up a changelog build by version, update stream name, or id.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        changelog</span>
<span class="sd">            Build version, update stream name, or build id.</span>
<span class="sd">        key</span>
<span class="sd">            Unset to query by build version or stream name, or ``id`` to query</span>
<span class="sd">            by build id.</span>
<span class="sd">        message_formats</span>
<span class="sd">            Format to return text of changelog entries in.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Lookup Changelog Build</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#lookup-changelog-build&gt;`__ endpoint.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="n">key</span><span class="p">,</span> <span class="s2">&quot;message_formats&quot;</span><span class="p">:</span> <span class="n">message_formats</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">Build</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;/changelog/</span><span class="si">{</span><span class="n">changelog</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>


    <span class="c1"># /chat</span>
    <span class="c1"># -----</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">CHAT_WRITE</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;chat&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">send_pm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">user_id</span><span class="p">:</span> <span class="n">UserIdT</span><span class="p">,</span>
        <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">is_action</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CreatePMResponse</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Send a pm to a user.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        user_id</span>
<span class="sd">            The user to send a message to.</span>
<span class="sd">        message</span>
<span class="sd">            The message to send.</span>
<span class="sd">        is_action</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Create New PM</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#create-new-pm&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;target_id&quot;</span><span class="p">:</span> <span class="n">user_id</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="n">message</span><span class="p">,</span>
            <span class="s2">&quot;is_action&quot;</span><span class="p">:</span> <span class="n">is_action</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="n">CreatePMResponse</span><span class="p">,</span> <span class="s2">&quot;/chat/new&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>

    <span class="c1"># this method requires a user in the announce group, so I&#39;ve never tested</span>
    <span class="c1"># it.</span>
    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">CHAT_WRITE</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;chat&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">send_announcement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">channel_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">channel_description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="c1"># TODO need to add support to automatic conversion for lists of id types</span>
        <span class="c1"># instead of just bare types (: UserIdT)</span>
        <span class="n">target_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">UserIdT</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ChatChannel</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Send an announcement message. You must be in the announce usergroup to</span>
<span class="sd">        use this endpoint (and if you don&#39;t know what that is, then you aren&#39;t</span>
<span class="sd">        in it).</span>

<span class="sd">        If you want to send a normal pm, see :meth:`send_pm`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        channel_name</span>
<span class="sd">            The name of the announce channel that will be created.</span>
<span class="sd">        channel_description</span>
<span class="sd">            The description of the announce channel that will be created.</span>
<span class="sd">        message</span>
<span class="sd">            The message to send.</span>
<span class="sd">        target_ids</span>
<span class="sd">            The users to send the message to.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Create Channel</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#create-channel&gt;`__ endpoint.</span>

<span class="sd">        Warnings</span>
<span class="sd">        --------</span>
<span class="sd">        I don&#39;t have an account in the announce usergroup, so I&#39;ve never tested</span>
<span class="sd">        this endpoint. If it breaks for you, please open an issue on github or</span>
<span class="sd">        dm me on discord (tybug#8490)!</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;channel.name&quot;</span><span class="p">:</span> <span class="n">channel_name</span><span class="p">,</span>
            <span class="s2">&quot;channel.description&quot;</span><span class="p">:</span> <span class="n">channel_description</span><span class="p">,</span>
            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="n">message</span><span class="p">,</span>
            <span class="s2">&quot;target_ids&quot;</span><span class="p">:</span> <span class="n">target_ids</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;ANNOUNCE&quot;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="n">ChatChannel</span><span class="p">,</span> <span class="s2">&quot;/chat/channels&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>


    <span class="c1"># /comments</span>
    <span class="c1"># ---------</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;comments&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">comments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">commentable_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">CommentableTypeT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">commentable_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">cursor</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Cursor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">parent_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sort</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">CommentSortT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CommentBundle</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get comments and their replies (up to 2 levels deep). If you only want</span>
<span class="sd">        to retrieve a single comment, see :meth:`comment`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        commentable_type</span>
<span class="sd">            The type of resource to get comments for.</span>
<span class="sd">        commentable_id</span>
<span class="sd">            The id of the resource to get comments for.</span>
<span class="sd">        cursor</span>
<span class="sd">            Cursor for pagination.</span>
<span class="sd">        parent_id</span>
<span class="sd">            Filter by id of the parent comment.</span>
<span class="sd">        sort</span>
<span class="sd">            How to sort the comments. Defaults to ``new`` for guest account and</span>
<span class="sd">            the user-specified default when authenticated.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get Comments</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#get-comments&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;commentable_type&quot;</span><span class="p">:</span> <span class="n">commentable_type</span><span class="p">,</span>
            <span class="s2">&quot;commentable_id&quot;</span><span class="p">:</span> <span class="n">commentable_id</span><span class="p">,</span> <span class="s2">&quot;cursor&quot;</span><span class="p">:</span> <span class="n">cursor</span><span class="p">,</span>
            <span class="s2">&quot;parent_id&quot;</span><span class="p">:</span> <span class="n">parent_id</span><span class="p">,</span> <span class="s2">&quot;sort&quot;</span><span class="p">:</span> <span class="n">sort</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">CommentBundle</span><span class="p">,</span> <span class="s2">&quot;/comments&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;comments&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">comment_id</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CommentBundle</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a comment and its replies (up to 2 levels deep).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        comment_id</span>
<span class="sd">            The comment to get.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get a Comment</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#get-a-comment&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">CommentBundle</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;/comments/</span><span class="si">{</span><span class="n">comment_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


    <span class="c1"># /forums</span>
    <span class="c1"># -------</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">FORUM_WRITE</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;forums&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">forum_create_topic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
       <span class="n">forum_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
       <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
       <span class="n">body</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
       <span class="o">*</span><span class="p">,</span>
       <span class="n">poll</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ForumPoll</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
   <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CreateForumTopicResponse</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        https://osu.ppy.sh/docs/index.html#create-topic</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="n">body</span><span class="p">,</span>
            <span class="s2">&quot;forum_id&quot;</span><span class="p">:</span> <span class="n">forum_id</span><span class="p">,</span>
            <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">poll</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;with_poll&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;forum_topic_poll[hide_results]&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">poll</span><span class="o">.</span><span class="n">hide_results</span>
            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;forum_topic_poll[length_days]&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">poll</span><span class="o">.</span><span class="n">length_days</span>
            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;forum_topic_poll[max_options]&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">poll</span><span class="o">.</span><span class="n">max_options</span>
            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;forum_topic_poll[options]&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">poll</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>
            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;forum_topic_poll[title]&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">poll</span><span class="o">.</span><span class="n">title</span>
            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;forum_topic_poll[vote_change]&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">poll</span><span class="o">.</span><span class="n">vote_change</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="n">CreateForumTopicResponse</span><span class="p">,</span> <span class="s2">&quot;/forums/topics&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">FORUM_WRITE</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;forums&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">forum_reply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">topic_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">body</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ForumPost</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reply to a forum topic.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        topic_id</span>
<span class="sd">            The topic to reply to.</span>
<span class="sd">        body</span>
<span class="sd">            Content of the reply.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Reply Topic</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#reply-topic&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="n">body</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="n">ForumPost</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;/forums/topics/</span><span class="si">{</span><span class="n">topic_id</span><span class="si">}</span><span class="s2">/reply&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">FORUM_WRITE</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;forums&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">forum_edit_topic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">topic_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ForumTopic</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Edit a forum topic.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ---------</span>
<span class="sd">        topic_id</span>
<span class="sd">            The topic to edit.</span>
<span class="sd">        title</span>
<span class="sd">            The new title of the topic.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Edit Topic</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#edit-topic&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;forum_topic[topic_title]&quot;</span><span class="p">:</span> <span class="n">title</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_put</span><span class="p">(</span><span class="n">ForumTopic</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;/forums/topics/</span><span class="si">{</span><span class="n">topic_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">FORUM_WRITE</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;forums&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">forum_edit_post</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">post_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">body</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ForumPost</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Edit a forum post.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        post_id</span>
<span class="sd">            The post to edit.</span>
<span class="sd">        body</span>
<span class="sd">            The new content of the post.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Edit Post</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#edit-post&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="n">body</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_put</span><span class="p">(</span><span class="n">ForumPost</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;/forums/posts/</span><span class="si">{</span><span class="n">post_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;forums&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">forum_topic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">topic_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">cursor_string</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sort</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ForumTopicSortT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">limit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">start</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">end</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ForumTopicAndPosts</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a forum topic and its posts.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        topic_id</span>
<span class="sd">            The topic to get.</span>
<span class="sd">        cursor_string</span>
<span class="sd">            Cursor for pagination.</span>
<span class="sd">        sort</span>
<span class="sd">            How to sort the posts.</span>
<span class="sd">        limit</span>
<span class="sd">            Maximum number of posts to return.</span>
<span class="sd">        start</span>
<span class="sd">            First post id to be returned when ``sort`` is</span>
<span class="sd">            :data:`ForumTopicSort.NEW &lt;ossapi.enums.ForumTopicSort.NEW&gt;`.</span>
<span class="sd">            Ignored otherwise.</span>
<span class="sd">        end</span>
<span class="sd">            First post id to be returned when ``sort`` is</span>
<span class="sd">            :data:`ForumTopicSort.OLD &lt;ossapi.enums.ForumTopicSort.OLD&gt;`.</span>
<span class="sd">            Ignored otherwise.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get Topic and Posts</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#get-topic-and-posts&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cursor_string&quot;</span><span class="p">:</span> <span class="n">cursor_string</span><span class="p">,</span> <span class="s2">&quot;sort&quot;</span><span class="p">:</span> <span class="n">sort</span><span class="p">,</span> <span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="n">limit</span><span class="p">,</span>
            <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="n">start</span><span class="p">,</span> <span class="s2">&quot;end&quot;</span><span class="p">:</span> <span class="n">end</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">ForumTopicAndPosts</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;/forums/topics/</span><span class="si">{</span><span class="n">topic_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">params</span><span class="p">)</span>


    <span class="c1"># /friends</span>
    <span class="c1"># --------</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">FRIENDS_READ</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;friends&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">friends</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">UserCompact</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the friends of the authenticated user.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get Friends</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#friends&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">List</span><span class="p">[</span><span class="n">UserCompact</span><span class="p">],</span> <span class="s2">&quot;/friends&quot;</span><span class="p">)</span>


    <span class="c1"># / (&quot;home&quot;)</span>
    <span class="c1"># ----------</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;home&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">mode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">SearchModeT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">page</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Search</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Search users and wiki pages. If you want to search beatmapsets, see</span>
<span class="sd">        :meth:`search_beatmapsets`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        query</span>
<span class="sd">            Search query.</span>
<span class="sd">        mode</span>
<span class="sd">            Filter results by type (forum, wiki, player, etc.).</span>
<span class="sd">        page</span>
<span class="sd">            Pagination for results.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Search</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#search&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="n">mode</span><span class="p">,</span> <span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="n">query</span><span class="p">,</span> <span class="s2">&quot;page&quot;</span><span class="p">:</span> <span class="n">page</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">Search</span><span class="p">,</span> <span class="s2">&quot;/search&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>


    <span class="c1"># /matches</span>
    <span class="c1"># --------</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;matches&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">matches</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matches</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get current matches. If you want to get a specific match, see</span>
<span class="sd">        :meth:`match`.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get Matches</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#matches&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">Matches</span><span class="p">,</span> <span class="s2">&quot;/matches&quot;</span><span class="p">)</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;matches&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">match_id</span><span class="p">:</span> <span class="n">MatchIdT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MatchResponse</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a match (eg https://osu.ppy.sh/community/matches/97947404).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        match_id</span>
<span class="sd">            The match to get.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get Match</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#matchesmatch&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">MatchResponse</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;/matches/</span><span class="si">{</span><span class="n">match_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


    <span class="c1"># /me</span>
    <span class="c1"># ---</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">IDENTIFY</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;me&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">get_me</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">mode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">GameModeT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get data about the authenticated user.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mode</span>
<span class="sd">            Get data about the specified mode. Defaults to the user&#39;s default</span>
<span class="sd">            mode.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get Own Data</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#get-own-data&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;/me/</span><span class="si">{</span><span class="n">mode</span><span class="o">.</span><span class="n">value</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


    <span class="c1"># /news</span>
    <span class="c1"># -----</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;news&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">news_listing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">limit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">year</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">cursor_string</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NewsListing</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get news posts.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        limit</span>
<span class="sd">            Maximum number of news posts to return.</span>
<span class="sd">        year</span>
<span class="sd">            Filter by year the news post was created.</span>
<span class="sd">        cursor_string</span>
<span class="sd">            Cursor for pagination.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get News Listing</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#get-news-listing&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="n">limit</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="n">year</span><span class="p">,</span> <span class="s2">&quot;cursor_string&quot;</span><span class="p">:</span> <span class="n">cursor_string</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">NewsListing</span><span class="p">,</span> <span class="s2">&quot;/news&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;news&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">news_post</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">news</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NewsPostKeyT</span><span class="p">]</span> <span class="o">=</span> <span class="n">NewsPostKey</span><span class="o">.</span><span class="n">SLUG</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NewsPost</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a news post by id or slug.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        news</span>
<span class="sd">            The id or slug of the news post.</span>
<span class="sd">        key</span>
<span class="sd">            Whether to query by id or slug.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get News Post</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#get-news-post&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># docs state key should be &quot;unset to query by slug&quot;</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="n">NewsPostKey</span><span class="o">.</span><span class="n">SLUG</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="n">key</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">NewsPost</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;/news/</span><span class="si">{</span><span class="n">news</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>


    <span class="c1"># /oauth</span>
    <span class="c1"># ------</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;oauth&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">revoke_token</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Revoke the current token. This will remove any authentication and leave</span>
<span class="sd">        you unable to make any more api calls until you re-authenticate.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Revoke Current Token</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#revoke-current-token&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">BASE_URL</span><span class="si">}</span><span class="s2">/oauth/tokens/current&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_token</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">token_key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">token_directory</span><span class="p">)</span>


    <span class="c1"># /rankings</span>
    <span class="c1"># ---------</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;rankings&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">ranking</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">mode</span><span class="p">:</span> <span class="n">GameModeT</span><span class="p">,</span>
        <span class="nb">type</span><span class="p">:</span> <span class="n">RankingTypeT</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">country</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">cursor</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Cursor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">filter_</span><span class="p">:</span> <span class="n">RankingFilterT</span> <span class="o">=</span> <span class="n">RankingFilter</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span>
        <span class="n">spotlight</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">variant</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rankings</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get current rankings for the specified game mode. Can specify ``type_``</span>
<span class="sd">        to get different types of rankings (performance, score, country, etc).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mode</span>
<span class="sd">            The mode to get rankings for.</span>
<span class="sd">        type</span>
<span class="sd">            The type of ranking to get.</span>
<span class="sd">        country</span>
<span class="sd">            Filter ranking by 2 letter country code. Only available for</span>
<span class="sd">            ``RankingType.PERFORMANCE``.</span>
<span class="sd">        cursor</span>
<span class="sd">            Cursor for pagination.</span>
<span class="sd">        filter_</span>
<span class="sd">            Filter ranking by specified filter.</span>
<span class="sd">        spotlight</span>
<span class="sd">            The id of the spotlight to return rankings for. Ranking for latest</span>
<span class="sd">            spotlight will be returned if not specified. Only available for</span>
<span class="sd">            ``RankingType.SPOTLIGHT``.</span>
<span class="sd">        variant</span>
<span class="sd">            Filter ranking by game mode variant. Either ``4k`` or ``7k`` for</span>
<span class="sd">            mania. Only available for ``RankingType.PERFORMANCE``.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get Ranking</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#get-ranking&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;country&quot;</span><span class="p">:</span> <span class="n">country</span><span class="p">,</span> <span class="s2">&quot;cursor&quot;</span><span class="p">:</span> <span class="n">cursor</span><span class="p">,</span> <span class="s2">&quot;filter&quot;</span><span class="p">:</span> <span class="n">filter_</span><span class="p">,</span>
            <span class="s2">&quot;spotlight&quot;</span><span class="p">:</span> <span class="n">spotlight</span><span class="p">,</span> <span class="s2">&quot;variant&quot;</span><span class="p">:</span> <span class="n">variant</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">Rankings</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;/rankings/</span><span class="si">{</span><span class="n">mode</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">type</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>


    <span class="c1"># /rooms</span>
    <span class="c1"># ------</span>

    <span class="c1"># TODO add test for this once I figure out values for room_id and</span>
    <span class="c1"># playlist_id that actually produce a response lol</span>
    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;rooms&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">multiplayer_scores</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">room_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">playlist_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">limit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sort</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MultiplayerScoresSortT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">cursor_string</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MultiplayerScores</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get scores on a playlist item in a room.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        room_id</span>
<span class="sd">            The room to get the scores from.</span>
<span class="sd">        playlist_id</span>
<span class="sd">            The playlist to get the scores from.</span>
<span class="sd">        limit</span>
<span class="sd">            Maximum number of scores to get.</span>
<span class="sd">        sort</span>
<span class="sd">            How to sort the scores.</span>
<span class="sd">        cursor_string</span>
<span class="sd">            Cursor for pagination.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get Scores</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#get-scores&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="n">limit</span><span class="p">,</span> <span class="s2">&quot;sort&quot;</span><span class="p">:</span> <span class="n">sort</span><span class="p">,</span> <span class="s2">&quot;cursor_string&quot;</span><span class="p">:</span> <span class="n">cursor_string</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">MultiplayerScores</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;/rooms/</span><span class="si">{</span><span class="n">room_id</span><span class="si">}</span><span class="s2">/playlist/</span><span class="si">{</span><span class="n">playlist_id</span><span class="si">}</span><span class="s2">/scores&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;rooms&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">room</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">room_id</span><span class="p">:</span> <span class="n">RoomIdT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Room</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a room.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        room_id</span>
<span class="sd">            The room to get.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get Room</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#roomsroom&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">Room</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;/rooms/</span><span class="si">{</span><span class="n">room_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">requires_user</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;rooms&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">room_leaderboard</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">room_id</span><span class="p">:</span> <span class="n">RoomIdT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RoomLeaderboard</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the leaderboard of a room.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        room_id</span>
<span class="sd">            The room to get the leaderboard of.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get Room Leaderboard</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#roomsroomleaderboard&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">RoomLeaderboard</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;/rooms/</span><span class="si">{</span><span class="n">room_id</span><span class="si">}</span><span class="s2">/leaderboard&quot;</span><span class="p">)</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">requires_user</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;rooms&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">rooms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RoomSearchTypeT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Room</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the list of current rooms.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        type</span>
<span class="sd">            Filter by room type. Default to all rooms.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get Rooms</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#roomsmode&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">List</span><span class="p">[</span><span class="n">Room</span><span class="p">],</span> <span class="sa">f</span><span class="s2">&quot;/rooms/</span><span class="si">{</span><span class="nb">type</span><span class="o">.</span><span class="n">value</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


    <span class="c1"># /scores</span>
    <span class="c1"># -------</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;scores&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">mode</span><span class="p">:</span> <span class="n">GameModeT</span><span class="p">,</span>
        <span class="n">score_id</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Score</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a score.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mode</span>
<span class="sd">            The mode the score was set on.</span>
<span class="sd">        score_id</span>
<span class="sd">            The score to get.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get Score</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#scoresmodescore&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">Score</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;/scores/</span><span class="si">{</span><span class="n">mode</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">score_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">requires_user</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;scores&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">download_score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">mode</span><span class="p">:</span> <span class="n">GameModeT</span><span class="p">,</span>
        <span class="n">score_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">raw</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Replay</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Download the replay data of a score.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mode</span>
<span class="sd">            The mode of the score to download.</span>
<span class="sd">        score_id</span>
<span class="sd">            The score to download.</span>
<span class="sd">        raw</span>
<span class="sd">            If ``True``, will return the raw string response from the api</span>
<span class="sd">            instead of a :class:`~ossapi.replay.Replay` object.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Download Score</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#scoresmodescoredownload&gt;`__</span>
<span class="sd">        endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">BASE_URL</span><span class="si">}</span><span class="s2">/scores/</span><span class="si">{</span><span class="n">mode</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">score_id</span><span class="si">}</span><span class="s2">/download&quot;</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

        <span class="c1"># if the response above succeeded, it will return a raw string</span>
        <span class="c1"># instead of json. If it didn&#39;t succeed, it will return json with an</span>
        <span class="c1"># error.</span>
        <span class="c1"># So always try parsing as json to check if there&#39;s an error. If parsin</span>
        <span class="c1"># fails, just assume the request succeeded and move on.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">json_</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_response</span><span class="p">(</span><span class="n">json_</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">if</span> <span class="n">raw</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">content</span>

        <span class="n">replay</span> <span class="o">=</span> <span class="n">osrparse</span><span class="o">.</span><span class="n">Replay</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Replay</span><span class="p">(</span><span class="n">replay</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>


    <span class="c1"># seasonal backgrounds</span>
    <span class="c1"># --------------------</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;seasonal backgrounds&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">seasonal_backgrounds</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SeasonalBackgrounds</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get current seasonal backgrounds.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Seasonal Backgrounds</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#seasonal-backgrounds&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">SeasonalBackgrounds</span><span class="p">,</span> <span class="s2">&quot;/seasonal-backgrounds&quot;</span><span class="p">)</span>


    <span class="c1"># /spotlights</span>
    <span class="c1"># -----------</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;spotlights&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">spotlights</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Spotlight</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get active spotlights.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get Spotlights</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#get-spotlights&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">spotlights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">Spotlights</span><span class="p">,</span> <span class="s2">&quot;/spotlights&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">spotlights</span><span class="o">.</span><span class="n">spotlights</span>


    <span class="c1"># /users</span>
    <span class="c1"># ------</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;users&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">user_kudosu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">user_id</span><span class="p">:</span> <span class="n">UserIdT</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">limit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">offset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">KudosuHistory</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get user kudosu history.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        user_id</span>
<span class="sd">            User to get kudosu history of.</span>
<span class="sd">        limit</span>
<span class="sd">            Maximum number of history events to return.</span>
<span class="sd">        offset</span>
<span class="sd">            Offset for pagination.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get User Kudosu</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#get-user-kudosu&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="n">limit</span><span class="p">,</span> <span class="s2">&quot;offset&quot;</span><span class="p">:</span> <span class="n">offset</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">List</span><span class="p">[</span><span class="n">KudosuHistory</span><span class="p">],</span> <span class="sa">f</span><span class="s2">&quot;/users/</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">/kudosu&quot;</span><span class="p">,</span>
            <span class="n">params</span><span class="p">)</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;users&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">user_scores</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">user_id</span><span class="p">:</span> <span class="n">UserIdT</span><span class="p">,</span>
        <span class="nb">type</span><span class="p">:</span> <span class="n">ScoreTypeT</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">include_fails</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">mode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">GameModeT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">limit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">offset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Score</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get scores of a user.</span>

<span class="sd">        user_id</span>
<span class="sd">            The user to get scores of.</span>
<span class="sd">        type</span>
<span class="sd">            Type of score to get.</span>
<span class="sd">        include_fails</span>
<span class="sd">            Whether to include failed scores.</span>
<span class="sd">        mode</span>
<span class="sd">            Filter scores by game mode. Defaults to the user&#39;s default mode.</span>
<span class="sd">        limit</span>
<span class="sd">            Maximum number of scores to return.</span>
<span class="sd">        offset</span>
<span class="sd">            Offset for pagination.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get User Scores</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#get-user-scores&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># `include_fails` is actually a string in the api spec. We&#39;ll still</span>
        <span class="c1"># require a bool to be passed, and just do the conversion behind the</span>
        <span class="c1"># scenes.</span>
        <span class="k">if</span> <span class="n">include_fails</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">include_fails</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">include_fails</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">include_fails</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;include_fails&quot;</span><span class="p">:</span> <span class="n">include_fails</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="n">mode</span><span class="p">,</span> <span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="n">limit</span><span class="p">,</span>
            <span class="s2">&quot;offset&quot;</span><span class="p">:</span> <span class="n">offset</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">List</span><span class="p">[</span><span class="n">Score</span><span class="p">],</span> <span class="sa">f</span><span class="s2">&quot;/users/</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">/scores/</span><span class="si">{</span><span class="nb">type</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">params</span><span class="p">)</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;users&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">user_beatmaps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">user_id</span><span class="p">:</span> <span class="n">UserIdT</span><span class="p">,</span>
        <span class="nb">type</span><span class="p">:</span> <span class="n">UserBeatmapTypeT</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">limit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">offset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Beatmapset</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">BeatmapPlaycount</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get beatmaps of a user.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        user_id</span>
<span class="sd">            The user to get beatmaps of.</span>
<span class="sd">        type_</span>
<span class="sd">            The type of beatmaps to get.</span>
<span class="sd">        limit</span>
<span class="sd">            Maximum number of beatmaps to get.</span>
<span class="sd">        offset</span>
<span class="sd">            Offset for pagination.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Returns :class:`~.BeatmapPlaycount` for</span>
<span class="sd">        :data:`UserBeatmapType.MOST_PLAYED</span>
<span class="sd">        &lt;ossapi.enums.UserBeatmapType.MOST_PLAYED&gt;`, and :class:`~.Beatmapset`</span>
<span class="sd">        otherwise.</span>

<span class="sd">        Implements `Get User Beatmaps</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#get-user-beatmaps&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="n">limit</span><span class="p">,</span> <span class="s2">&quot;offset&quot;</span><span class="p">:</span> <span class="n">offset</span><span class="p">}</span>

        <span class="n">return_type</span> <span class="o">=</span> <span class="n">List</span><span class="p">[</span><span class="n">Beatmapset</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">type</span> <span class="ow">is</span> <span class="n">UserBeatmapType</span><span class="o">.</span><span class="n">MOST_PLAYED</span><span class="p">:</span>
            <span class="n">return_type</span> <span class="o">=</span> <span class="n">List</span><span class="p">[</span><span class="n">BeatmapPlaycount</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">return_type</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;/users/</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">/beatmapsets/</span><span class="si">{</span><span class="nb">type</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;users&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">user_recent_activity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">user_id</span><span class="p">:</span> <span class="n">UserIdT</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">limit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">offset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Event</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get recent activity of a user.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        user_id</span>
<span class="sd">            The user to get recent activity of.</span>
<span class="sd">        limit</span>
<span class="sd">            Maximum number of events to return.</span>
<span class="sd">        offset</span>
<span class="sd">            Offset for pagination.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get User Recent Activity</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#get-user-recent-activity&gt;`__</span>
<span class="sd">        endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="n">limit</span><span class="p">,</span> <span class="s2">&quot;offset&quot;</span><span class="p">:</span> <span class="n">offset</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">List</span><span class="p">[</span><span class="n">_Event</span><span class="p">],</span> <span class="sa">f</span><span class="s2">&quot;/users/</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">/recent_activity/&quot;</span><span class="p">,</span>
            <span class="n">params</span><span class="p">)</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;users&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">user</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">UserIdT</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">mode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">GameModeT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UserLookupKeyT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">User</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a user by id or username.</span>

<span class="sd">        user</span>
<span class="sd">            The user id or username of the user to get.</span>
<span class="sd">        mode</span>
<span class="sd">            The mode of the user to get details from. Default mode of the user</span>
<span class="sd">            will be used if not specified.</span>
<span class="sd">        key</span>
<span class="sd">            Whether to query by id or username. Defaults to automatic detection</span>
<span class="sd">            if not passed.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get User</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#get-user&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="n">key</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;/users/</span><span class="si">{</span><span class="n">user</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">mode</span><span class="o">.</span><span class="n">value</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">params</span><span class="p">)</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">Scope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;users&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">users</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">user_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">UserCompact</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Batch get users by id. If you only want to retrieve a single user, or</span>
<span class="sd">        want to retrieve users by username instead of id, see :meth:`user`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ---------</span>
<span class="sd">        user_ids</span>
<span class="sd">            The users to get.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get Users</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#get-users&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ids&quot;</span><span class="p">:</span> <span class="n">user_ids</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">Users</span><span class="p">,</span> <span class="s2">&quot;/users&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span><span class="o">.</span><span class="n">users</span>

    <span class="c1"># /wiki</span>
    <span class="c1"># -----</span>

    <span class="nd">@request</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;wiki&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">wiki_page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">locale</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WikiPage</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a wiki page.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        locale</span>
<span class="sd">            two letter language code of the wiki page.</span>
<span class="sd">        path</span>
<span class="sd">            The path name of the wiki page.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Implements the `Get Wiki Page</span>
<span class="sd">        &lt;https://osu.ppy.sh/docs/index.html#get-wiki-page&gt;`__ endpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">WikiPage</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;/wiki/</span><span class="si">{</span><span class="n">locale</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
</pre></div>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/scripts/furo.js"></script>
    </body>
</html>